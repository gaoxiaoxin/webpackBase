{"version":3,"file":"js/page4/page4-bundle.js","mappings":"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","sources":["webpack://webpack-base/./src/pages/page4/app.js","webpack://webpack-base/./src/pages/page4/css/index.less","webpack://webpack-base/./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","webpack://webpack-base/./node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","webpack://webpack-base/./node_modules/@babel/runtime/helpers/esm/classCallCheck.js","webpack://webpack-base/./node_modules/@babel/runtime/helpers/esm/createClass.js","webpack://webpack-base/./node_modules/@babel/runtime/helpers/esm/iterableToArray.js","webpack://webpack-base/./node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","webpack://webpack-base/./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","webpack://webpack-base/./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js"],"sourcesContent":["// fcreen.js\r\n/*\r\n此源码是基于 XgpNwb 的二次修改\r\nGithub：https://github.com/NianBroken/Firework_Simulator\r\nGitee：https://gitee.com/nianbroken/Firework_Simulator\r\n*/\r\nimport \"./css/index.less\";\r\nimport axios from \"axios\";\r\n(function (global) {\r\n  \"use strict\";\r\n\r\n  var key = {\r\n    fullscreenEnabled: 0,\r\n    fullscreenElement: 1,\r\n    requestFullscreen: 2,\r\n    exitFullscreen: 3,\r\n    fullscreenchange: 4,\r\n    fullscreenerror: 5,\r\n  };\r\n\r\n  var webkit = [\r\n    \"webkitFullscreenEnabled\",\r\n    \"webkitFullscreenElement\",\r\n    \"webkitRequestFullscreen\",\r\n    \"webkitExitFullscreen\",\r\n    \"webkitfullscreenchange\",\r\n    \"webkitfullscreenerror\",\r\n  ];\r\n\r\n  var moz = [\r\n    \"mozFullScreenEnabled\",\r\n    \"mozFullScreenElement\",\r\n    \"mozRequestFullScreen\",\r\n    \"mozCancelFullScreen\",\r\n    \"mozfullscreenchange\",\r\n    \"mozfullscreenerror\",\r\n  ];\r\n\r\n  var ms = [\r\n    \"msFullscreenEnabled\",\r\n    \"msFullscreenElement\",\r\n    \"msRequestFullscreen\",\r\n    \"msExitFullscreen\",\r\n    \"MSFullscreenChange\",\r\n    \"MSFullscreenError\",\r\n  ];\r\n\r\n  // so it doesn't throw if no window or document\r\n  // The language of this project was translated into Chinese by Nianbroken\r\n  var doc =\r\n    typeof window !== \"undefined\" && typeof window.document !== \"undefined\"\r\n      ? window.document\r\n      : {};\r\n\r\n  var vendor =\r\n    (\"fullscreenEnabled\" in doc && Object.keys(key)) ||\r\n    (webkit[0] in doc && webkit) ||\r\n    (moz[0] in doc && moz) ||\r\n    (ms[0] in doc && ms) ||\r\n    [];\r\n\r\n  var fscreen = {\r\n    requestFullscreen: function requestFullscreen(element) {\r\n      return element[vendor[key.requestFullscreen]]();\r\n    },\r\n    requestFullscreenFunction: function requestFullscreenFunction(element) {\r\n      return element[vendor[key.requestFullscreen]];\r\n    },\r\n    get exitFullscreen() {\r\n      return doc[vendor[key.exitFullscreen]].bind(doc);\r\n    },\r\n    addEventListener: function addEventListener(type, handler, options) {\r\n      return doc.addEventListener(vendor[key[type]], handler, options);\r\n    },\r\n    removeEventListener: function removeEventListener(type, handler) {\r\n      return doc.removeEventListener(vendor[key[type]], handler);\r\n    },\r\n    get fullscreenEnabled() {\r\n      return Boolean(doc[vendor[key.fullscreenEnabled]]);\r\n    },\r\n    set fullscreenEnabled(val) {},\r\n    get fullscreenElement() {\r\n      return doc[vendor[key.fullscreenElement]];\r\n    },\r\n    set fullscreenElement(val) {},\r\n    get onfullscreenchange() {\r\n      return doc[(\"on\" + vendor[key.fullscreenchange]).toLowerCase()];\r\n    },\r\n    set onfullscreenchange(handler) {\r\n      return (doc[(\"on\" + vendor[key.fullscreenchange]).toLowerCase()] =\r\n        handler);\r\n    },\r\n    get onfullscreenerror() {\r\n      return doc[(\"on\" + vendor[key.fullscreenerror]).toLowerCase()];\r\n    },\r\n    set onfullscreenerror(handler) {\r\n      return (doc[(\"on\" + vendor[key.fullscreenerror]).toLowerCase()] =\r\n        handler);\r\n    },\r\n  };\r\n\r\n  global.fscreen = fscreen;\r\n})(window);\r\n\r\n// Stage.js\r\n/*\r\n此源码是基于 XgpNwb 的二次修改\r\nGithub：https://github.com/NianBroken/Firework_Simulator\r\nGitee：https://gitee.com/nianbroken/Firework_Simulator\r\n*/\r\nconst Ticker = (function TickerFactory(window) {\r\n  \"use strict\";\r\n\r\n  const Ticker = {};\r\n\r\n  // public\r\n  // will call function reference repeatedly once registered, passing elapsed time and a lag multiplier as parameters\r\n  Ticker.addListener = function addListener(callback) {\r\n    if (typeof callback !== \"function\")\r\n      throw \"Ticker.addListener() requires a function reference passed for a callback.\";\r\n\r\n    listeners.push(callback);\r\n\r\n    // start frame-loop lazily\r\n    if (!started) {\r\n      started = true;\r\n      queueFrame();\r\n    }\r\n  };\r\n\r\n  // private\r\n  let started = false;\r\n  let lastTimestamp = 0;\r\n  let listeners = [];\r\n\r\n  // queue up a new frame (calls frameHandler)\r\n  function queueFrame() {\r\n    if (window.requestAnimationFrame) {\r\n      requestAnimationFrame(frameHandler);\r\n    } else {\r\n      webkitRequestAnimationFrame(frameHandler);\r\n    }\r\n  }\r\n\r\n  function frameHandler(timestamp) {\r\n    let frameTime = timestamp - lastTimestamp;\r\n    lastTimestamp = timestamp;\r\n    // make sure negative time isn't reported (first frame can be whacky)\r\n    if (frameTime < 0) {\r\n      frameTime = 17;\r\n    }\r\n    // - cap minimum framerate to 15fps[~68ms] (assuming 60fps[~17ms] as 'normal')\r\n    else if (frameTime > 68) {\r\n      frameTime = 68;\r\n    }\r\n\r\n    // fire custom listeners\r\n    listeners.forEach((listener) =>\r\n      listener.call(window, frameTime, frameTime / 16.6667)\r\n    );\r\n\r\n    // always queue another frame\r\n    queueFrame();\r\n  }\r\n\r\n  return Ticker;\r\n})(window);\r\n\r\nconst Stage = (function StageFactory(window, document, Ticker) {\r\n  \"use strict\";\r\n\r\n  // Track touch times to prevent redundant mouse events.\r\n  let lastTouchTimestamp = 0;\r\n\r\n  // Stage constructor (canvas can be a dom node, or an id string)\r\n  function Stage(canvas) {\r\n    if (typeof canvas === \"string\") canvas = document.getElementById(canvas);\r\n\r\n    // canvas and associated context references\r\n    this.canvas = canvas;\r\n    this.ctx = canvas.getContext(\"2d\");\r\n\r\n    // Prevent gestures on stages (scrolling, zooming, etc)\r\n    this.canvas.style.touchAction = \"none\";\r\n\r\n    // physics speed multiplier: allows slowing down or speeding up simulation (must be manually implemented in physics layer)\r\n    this.speed = 1;\r\n\r\n    // devicePixelRatio alias (should only be used for rendering, physics shouldn't care)\r\n    // avoids rendering unnecessary pixels that browser might handle natively via CanvasRenderingContext2D.backingStorePixelRatio\r\n    // Language translation of this project into Chinese by Nianbroken\r\n    this.dpr = Stage.disableHighDPI\r\n      ? 1\r\n      : (window.devicePixelRatio || 1) / (this.ctx.backingStorePixelRatio || 1);\r\n\r\n    // canvas size in DIPs and natural pixels\r\n    this.width = canvas.width;\r\n    this.height = canvas.height;\r\n    this.naturalWidth = this.width * this.dpr;\r\n    this.naturalHeight = this.height * this.dpr;\r\n\r\n    // size canvas to match natural size\r\n    if (this.width !== this.naturalWidth) {\r\n      this.canvas.width = this.naturalWidth;\r\n      this.canvas.height = this.naturalHeight;\r\n      this.canvas.style.width = this.width + \"px\";\r\n      this.canvas.style.height = this.height + \"px\";\r\n    }\r\n\r\n    // To any known illigitimate users...\r\n    const badDomains = [\"bla\" + \"ckdiam\" + \"ondfirew\" + \"orks\" + \".de\"];\r\n    const hostname = document.location.hostname;\r\n    if (badDomains.some((d) => hostname.includes(d))) {\r\n      const delay = 60000 * 3; // 3 minutes\r\n      setTimeout(() => {\r\n        const html =\r\n          `<sty` +\r\n          `le>\r\n` +\r\n          `\t\t\t\t` +\r\n          `\t\tbo` +\r\n          `dy { bac` +\r\n          `kgrou` +\r\n          `nd-colo` +\r\n          `r: #000;` +\r\n          ` padd` +\r\n          `ing: ` +\r\n          `20px; text-` +\r\n          `align:` +\r\n          ` center; col` +\r\n          `or: ` +\r\n          `#ddd` +\r\n          `; mi` +\r\n          `n-he` +\r\n          `ight` +\r\n          `: 10` +\r\n          `0vh;` +\r\n          ` dis` +\r\n          `play` +\r\n          `: fl` +\r\n          `ex; ` +\r\n          `flex` +\r\n          `-dir` +\r\n          `ecti` +\r\n          `on: ` +\r\n          `colu` +\r\n          `mn; ` +\r\n          `just` +\r\n          `ify-` +\r\n          `cont` +\r\n          `ent:` +\r\n          ` cen` +\r\n          `ter;` +\r\n          ` ali` +\r\n          `gn-i` +\r\n          `tems` +\r\n          `: ce` +\r\n          `nter` +\r\n          `; ov` +\r\n          `erfl` +\r\n          `ow: ` +\r\n          `visi` +\r\n          `ble;` +\r\n          ` }\r\n\t` +\r\n          `\t\t\t\t` +\r\n          `\th1 ` +\r\n          `{ fo` +\r\n          `nt-s` +\r\n          `ize:` +\r\n          ` 1.2` +\r\n          `em;` +\r\n          `}\r\n\t\t` +\r\n          `\t\t\t\t` +\r\n          `p { ` +\r\n          `marg` +\r\n          `in-t` +\r\n          `op: ` +\r\n          `1em;` +\r\n          ` max` +\r\n          `-wid` +\r\n          `th: ` +\r\n          `36em` +\r\n          `; }\r\n` +\r\n          `\t\t\t\t` +\r\n          `\t\ta ` +\r\n          `{ co` +\r\n          `lor:` +\r\n          ` #ff` +\r\n          `f; tex` +\r\n          `t-dec` +\r\n          `orati` +\r\n          `on: u` +\r\n          `nderl` +\r\n          `ine; }` +\r\n          `\r\n\t\t\t` +\r\n          `\t\t</` +\r\n          `styl` +\r\n          `e>\r\n\t` +\r\n          `\t\t\t\t` +\r\n          `<h1>` +\r\n          `Hi! ` +\r\n          `Sorr` +\r\n          `y to` +\r\n          ` int` +\r\n          `erru` +\r\n          `pt t` +\r\n          `he f` +\r\n          `irew` +\r\n          `orks` +\r\n          `.</h` +\r\n          `1>\r\n\t` +\r\n          `\t\t\t\t` +\r\n          `<p>M` +\r\n          `y na` +\r\n          `me i` +\r\n          `s Ca` +\r\n          `leb.` +\r\n          ` Des` +\r\n          `pite` +\r\n          ` wha` +\r\n          `t th` +\r\n          `is s` +\r\n          `ite ` +\r\n          `clai` +\r\n          `ms, ` +\r\n          `I de` +\r\n          `sign` +\r\n          `ed a` +\r\n          `nd b` +\r\n          `uilt` +\r\n          ` thi` +\r\n          `s so` +\r\n          `ftwa` +\r\n          `re m` +\r\n          `ysel` +\r\n          `f. I` +\r\n          `'ve ` +\r\n          `spen` +\r\n          `t a ` +\r\n          `coup` +\r\n          `le h` +\r\n          `undr` +\r\n          `ed h` +\r\n          `ours` +\r\n          ` of ` +\r\n          `my o` +\r\n          `wn t` +\r\n          `ime, ` +\r\n          `over` +\r\n          ` tw` +\r\n          `o ye` +\r\n          `ars, ` +\r\n          `maki` +\r\n          `ng i` +\r\n          `t.</` +\r\n          `p>\r\n\t` +\r\n          `\t\t\t\t` +\r\n          `<p>T` +\r\n          `he o` +\r\n          `wner` +\r\n          ` of ` +\r\n          `this` +\r\n          ` sit` +\r\n          `e cl` +\r\n          `earl` +\r\n          `y do` +\r\n          `esn'` +\r\n          `t re` +\r\n          `spec` +\r\n          `t my` +\r\n          ` wor` +\r\n          `k, a` +\r\n          `nd h` +\r\n          `as l` +\r\n          `abel` +\r\n          `ed i` +\r\n          `t as` +\r\n          ` the` +\r\n          `ir o` +\r\n          `wn.<` +\r\n          `/p>\r\n` +\r\n          `\t\t\t\t` +\r\n          `\t<p>` +\r\n          `If y` +\r\n          `ou w` +\r\n          `ere ` +\r\n          `enjo` +\r\n          `ying` +\r\n          ` the` +\r\n          ` sho` +\r\n          `w, p` +\r\n          `leas` +\r\n          `e ch` +\r\n          `eck ` +\r\n          `out ` +\r\n          `<a h` +\r\n          `ref=` +\r\n          `\"htt` +\r\n          `ps:/` +\r\n          `/cod` +\r\n          `epen` +\r\n          `.io/` +\r\n          `Mill` +\r\n          `erTi` +\r\n          `me/f` +\r\n          `ull/` +\r\n          `XgpN` +\r\n          `wb\">` +\r\n          `my&n` +\r\n          `bsp;` +\r\n          `offi` +\r\n          `cial` +\r\n          `&nbs` +\r\n          `p;ve` +\r\n          `rsio` +\r\n          `n&nb` +\r\n          `sp;h` +\r\n          `ere<` +\r\n          `/a>!` +\r\n          `</p>\r\n` +\r\n          `\t\t\t\t` +\r\n          `\t<p>I` +\r\n          `f you` +\r\n          `'re th` +\r\n          `e ow` +\r\n          `ner, <a` +\r\n          ` href=\"m` +\r\n          `ailt` +\r\n          `o:cal` +\r\n          `ebdotmi` +\r\n          `ller@` +\r\n          `gmai` +\r\n          `l.co` +\r\n          `m\">cont` +\r\n          `act m` +\r\n          `e</a>` +\r\n          `.</p>`;\r\n        document.body.innerHTML = html;\r\n      }, delay);\r\n    }\r\n\r\n    Stage.stages.push(this);\r\n\r\n    // event listeners (note that 'ticker' is also an option, for frame events)\r\n    this._listeners = {\r\n      // canvas resizing\r\n      resize: [],\r\n      // pointer events\r\n      pointerstart: [],\r\n      pointermove: [],\r\n      pointerend: [],\r\n      lastPointerPos: { x: 0, y: 0 },\r\n    };\r\n  }\r\n\r\n  // track all Stage instances\r\n  Stage.stages = [];\r\n\r\n  // allow turning off high DPI support for perf reasons (enabled by default)\r\n  // Note: MUST be set before Stage construction.\r\n  // Each stage tracks its own DPI (initialized at construction time), so you can effectively allow some Stages to render high-res graphics but not others.\r\n  // Language translation of this project into Chinese by Nianbroken\r\n  Stage.disableHighDPI = false;\r\n\r\n  // events\r\n  Stage.prototype.addEventListener = function addEventListener(event, handler) {\r\n    try {\r\n      if (event === \"ticker\") {\r\n        Ticker.addListener(handler);\r\n      } else {\r\n        this._listeners[event].push(handler);\r\n      }\r\n    } catch (e) {\r\n      throw \"Invalid Event\";\r\n    }\r\n  };\r\n\r\n  Stage.prototype.dispatchEvent = function dispatchEvent(event, val) {\r\n    const listeners = this._listeners[event];\r\n    if (listeners) {\r\n      listeners.forEach((listener) => listener.call(this, val));\r\n    } else {\r\n      throw \"Invalid Event\";\r\n    }\r\n  };\r\n\r\n  // resize canvas\r\n  Stage.prototype.resize = function resize(w, h) {\r\n    this.width = w;\r\n    this.height = h;\r\n    this.naturalWidth = w * this.dpr;\r\n    this.naturalHeight = h * this.dpr;\r\n    this.canvas.width = this.naturalWidth;\r\n    this.canvas.height = this.naturalHeight;\r\n    this.canvas.style.width = w + \"px\";\r\n    this.canvas.style.height = h + \"px\";\r\n\r\n    this.dispatchEvent(\"resize\");\r\n  };\r\n\r\n  // utility function for coordinate space conversion\r\n  Stage.windowToCanvas = function windowToCanvas(canvas, x, y) {\r\n    const bbox = canvas.getBoundingClientRect();\r\n    return {\r\n      x: (x - bbox.left) * (canvas.width / bbox.width),\r\n      y: (y - bbox.top) * (canvas.height / bbox.height),\r\n    };\r\n  };\r\n  // handle interaction\r\n  Stage.mouseHandler = function mouseHandler(evt) {\r\n    // Prevent mouse events from firing immediately after touch events\r\n    if (Date.now() - lastTouchTimestamp < 500) {\r\n      return;\r\n    }\r\n\r\n    let type = \"start\";\r\n    if (evt.type === \"mousemove\") {\r\n      type = \"move\";\r\n    } else if (evt.type === \"mouseup\") {\r\n      type = \"end\";\r\n    }\r\n\r\n    Stage.stages.forEach((stage) => {\r\n      const pos = Stage.windowToCanvas(stage.canvas, evt.clientX, evt.clientY);\r\n      stage.pointerEvent(type, pos.x / stage.dpr, pos.y / stage.dpr);\r\n    });\r\n  };\r\n  Stage.touchHandler = function touchHandler(evt) {\r\n    lastTouchTimestamp = Date.now();\r\n\r\n    // Set generic event type\r\n    let type = \"start\";\r\n    if (evt.type === \"touchmove\") {\r\n      type = \"move\";\r\n    } else if (evt.type === \"touchend\") {\r\n      type = \"end\";\r\n    }\r\n\r\n    // Dispatch \"pointer events\" for all changed touches across all stages.\r\n    Stage.stages.forEach((stage) => {\r\n      // Safari doesn't treat a TouchList as an iteratable, hence Array.from()\r\n      for (let touch of Array.from(evt.changedTouches)) {\r\n        let pos;\r\n        if (type !== \"end\") {\r\n          pos = Stage.windowToCanvas(\r\n            stage.canvas,\r\n            touch.clientX,\r\n            touch.clientY\r\n          );\r\n          stage._listeners.lastPointerPos = pos;\r\n          // before touchstart event, fire a move event to better emulate cursor events\r\n          // Language translation of this project into Chinese by Nianbroken\r\n          if (type === \"start\")\r\n            stage.pointerEvent(\"move\", pos.x / stage.dpr, pos.y / stage.dpr);\r\n        } else {\r\n          // on touchend, fill in position information based on last known touch location\r\n          pos = stage._listeners.lastPointerPos;\r\n        }\r\n        stage.pointerEvent(type, pos.x / stage.dpr, pos.y / stage.dpr);\r\n      }\r\n    });\r\n  };\r\n\r\n  // dispatch a normalized pointer event on a specific stage\r\n  Stage.prototype.pointerEvent = function pointerEvent(type, x, y) {\r\n    // build event oject to dispatch\r\n    const evt = {\r\n      type: type,\r\n      x: x,\r\n      y: y,\r\n    };\r\n\r\n    // whether pointer event was dispatched over canvas element\r\n    evt.onCanvas = x >= 0 && x <= this.width && y >= 0 && y <= this.height;\r\n\r\n    // dispatch\r\n    this.dispatchEvent(\"pointer\" + type, evt);\r\n  };\r\n\r\n  document.addEventListener(\"mousedown\", Stage.mouseHandler);\r\n  document.addEventListener(\"mousemove\", Stage.mouseHandler);\r\n  document.addEventListener(\"mouseup\", Stage.mouseHandler);\r\n  document.addEventListener(\"touchstart\", Stage.touchHandler);\r\n  document.addEventListener(\"touchmove\", Stage.touchHandler);\r\n  document.addEventListener(\"touchend\", Stage.touchHandler);\r\n\r\n  return Stage;\r\n})(window, document, Ticker);\r\n\r\n// MyMath.js\r\n/*\r\n此源码是基于 XgpNwb 的二次修改\r\nGithub：https://github.com/NianBroken/Firework_Simulator\r\nGitee：https://gitee.com/nianbroken/Firework_Simulator\r\n*/\r\nconst MyMath = (function MyMathFactory(Math) {\r\n  const MyMath = {};\r\n\r\n  // degree/radian conversion constants\r\n  MyMath.toDeg = 180 / Math.PI;\r\n  MyMath.toRad = Math.PI / 180;\r\n  MyMath.halfPI = Math.PI / 2;\r\n  MyMath.twoPI = Math.PI * 2;\r\n\r\n  // Pythagorean Theorem distance calculation\r\n  MyMath.dist = (width, height) => {\r\n    return Math.sqrt(width * width + height * height);\r\n  };\r\n\r\n  // Pythagorean Theorem point distance calculation\r\n  // Same as above, but takes coordinates instead of dimensions.\r\n  // The language of this project was translated into Chinese by Nianbroken\r\n  MyMath.pointDist = (x1, y1, x2, y2) => {\r\n    const distX = x2 - x1;\r\n    const distY = y2 - y1;\r\n    return Math.sqrt(distX * distX + distY * distY);\r\n  };\r\n\r\n  // Returns the angle (in radians) of a 2D vector\r\n  MyMath.angle = (width, height) => MyMath.halfPI + Math.atan2(height, width);\r\n\r\n  // Returns the angle (in radians) between two points\r\n  // Same as above, but takes coordinates instead of dimensions.\r\n  MyMath.pointAngle = (x1, y1, x2, y2) =>\r\n    MyMath.halfPI + Math.atan2(y2 - y1, x2 - x1);\r\n\r\n  // Splits a speed vector into x and y components (angle needs to be in radians)\r\n  MyMath.splitVector = (speed, angle) => ({\r\n    x: Math.sin(angle) * speed,\r\n    y: -Math.cos(angle) * speed,\r\n  });\r\n\r\n  // Generates a random number between min (inclusive) and max (exclusive)\r\n  MyMath.random = (min, max) => Math.random() * (max - min) + min;\r\n\r\n  // Generates a random integer between and possibly including min and max values\r\n  MyMath.randomInt = (min, max) =>\r\n    ((Math.random() * (max - min + 1)) | 0) + min;\r\n\r\n  // Returns a random element from an array, or simply the set of provided arguments when called\r\n  MyMath.randomChoice = function randomChoice(choices) {\r\n    if (arguments.length === 1 && Array.isArray(choices)) {\r\n      return choices[(Math.random() * choices.length) | 0];\r\n    }\r\n    return arguments[(Math.random() * arguments.length) | 0];\r\n  };\r\n\r\n  // Clamps a number between min and max values\r\n  MyMath.clamp = function clamp(num, min, max) {\r\n    return Math.min(Math.max(num, min), max);\r\n  };\r\n\r\n  return MyMath;\r\n})(Math);\r\n\r\n/*\r\n此源码是基于 XgpNwb 的二次修改\r\nGithub：https://github.com/NianBroken/Firework_Simulator\r\nGitee：https://gitee.com/nianbroken/Firework_Simulator\r\n*/\r\n(\"use strict\");\r\nconsole.clear();\r\n\r\n// This is a prime example of what starts out as a simple project\r\n// and snowballs way beyond its intended size. It's a little clunky\r\n// reading/working on this single file, but here it is anyways :)\r\n\r\nconst IS_MOBILE = window.innerWidth <= 640;\r\nconst IS_DESKTOP = window.innerWidth > 800;\r\nconst IS_HEADER = IS_DESKTOP && window.innerHeight < 300;\r\n// Detect high end devices. This will be a moving target.\r\nconst IS_HIGH_END_DEVICE = (() => {\r\n  const hwConcurrency = navigator.hardwareConcurrency;\r\n  if (!hwConcurrency) {\r\n    return false;\r\n  }\r\n  // Large screens indicate a full size computer, which often have hyper threading these days.\r\n  // So a quad core desktop machine has 8 cores. We'll place a higher min threshold there.\r\n  const minCount = window.innerWidth <= 1024 ? 4 : 8;\r\n  return hwConcurrency >= minCount;\r\n})();\r\n// Prevent canvases from getting too large on ridiculous screen sizes.\r\n// 8K - can restrict this if needed\r\nconst MAX_WIDTH = 7680;\r\nconst MAX_HEIGHT = 4320;\r\nconst GRAVITY = 0.9; // Acceleration in px/s\r\nlet simSpeed = 1;\r\n\r\nfunction getDefaultScaleFactor() {\r\n  if (IS_MOBILE) return 0.9;\r\n  if (IS_HEADER) return 0.75;\r\n  return 1;\r\n}\r\n\r\n// Width/height values that take scale into account.\r\n// USE THESE FOR DRAWING POSITIONS\r\nlet stageW, stageH;\r\n\r\n// All quality globals will be overwritten and updated via `configDidUpdate`.\r\nlet quality = 1;\r\nlet isLowQuality = false;\r\nlet isNormalQuality = true;\r\nlet isHighQuality = false;\r\n\r\nconst QUALITY_LOW = 1;\r\nconst QUALITY_NORMAL = 2;\r\nconst QUALITY_HIGH = 3;\r\n\r\nconst SKY_LIGHT_NONE = 0;\r\nconst SKY_LIGHT_DIM = 1;\r\nconst SKY_LIGHT_NORMAL = 2;\r\n\r\nconst COLOR = {\r\n  Red: \"#ff0043\",\r\n  Green: \"#14fc56\",\r\n  Blue: \"#1e7fff\",\r\n  Purple: \"#e60aff\",\r\n  Gold: \"#ffbf36\",\r\n  White: \"#ffffff\",\r\n};\r\n\r\n// Special invisible color (not rendered, and therefore not in COLOR map)\r\nconst INVISIBLE = \"_INVISIBLE_\";\r\n\r\nconst PI_2 = Math.PI * 2;\r\nconst PI_HALF = Math.PI * 0.5;\r\n\r\n// Stage.disableHighDPI = true;\r\nconst trailsStage = new Stage(\"trails-canvas\");\r\nconst mainStage = new Stage(\"main-canvas\");\r\nconst stages = [trailsStage, mainStage];\r\n\r\n// Fullscreen helpers, using Fscreen for prefixes.\r\nfunction fullscreenEnabled() {\r\n  return fscreen.fullscreenEnabled;\r\n}\r\n\r\n// Note that fullscreen state is synced to store, and the store should be the source\r\n// of truth for whether the app is in fullscreen mode or not.\r\nfunction isFullscreen() {\r\n  return !!fscreen.fullscreenElement;\r\n}\r\n\r\n// Attempt to toggle fullscreen mode.\r\nfunction toggleFullscreen() {\r\n  if (fullscreenEnabled()) {\r\n    if (isFullscreen()) {\r\n      fscreen.exitFullscreen();\r\n    } else {\r\n      fscreen.requestFullscreen(document.documentElement);\r\n    }\r\n  }\r\n}\r\n\r\n// Sync fullscreen changes with store. An event listener is necessary because the user can\r\n// toggle fullscreen mode directly through the browser, and we want to react to that.\r\n// The language of this project was translated into Chinese by Nianbroken\r\nfscreen.addEventListener(\"fullscreenchange\", () => {\r\n  store.setState({ fullscreen: isFullscreen() });\r\n});\r\n\r\n// Simple state container; the source of truth.\r\nconst store = {\r\n  _listeners: new Set(),\r\n  _dispatch(prevState) {\r\n    this._listeners.forEach((listener) => listener(this.state, prevState));\r\n  },\r\n\r\n  state: {\r\n    // will be unpaused in init()\r\n    paused: true,\r\n    soundEnabled: true,\r\n    menuOpen: false,\r\n    openHelpTopic: null,\r\n    fullscreen: isFullscreen(),\r\n    // Note that config values used for <select>s must be strings, unless manually converting values to strings\r\n    // at render time, and parsing on change.\r\n    config: {\r\n      quality: String(IS_HIGH_END_DEVICE ? QUALITY_HIGH : QUALITY_NORMAL), // will be mirrored to a global variable named `quality` in `configDidUpdate`, for perf.\r\n      shell: \"Random\",\r\n      size: IS_DESKTOP\r\n        ? \"3\" // Desktop default\r\n        : IS_HEADER\r\n        ? \"1.2\" // Profile header default (doesn't need to be an int)\r\n        : \"2\", // Mobile default\r\n      autoLaunch: true,\r\n      finale: true,\r\n      skyLighting: SKY_LIGHT_NORMAL + \"\",\r\n      hideControls: IS_HEADER,\r\n      longExposure: false,\r\n      scaleFactor: getDefaultScaleFactor(),\r\n    },\r\n  },\r\n\r\n  setState(nextState) {\r\n    const prevState = this.state;\r\n    this.state = Object.assign({}, this.state, nextState);\r\n    this._dispatch(prevState);\r\n    this.persist();\r\n  },\r\n\r\n  subscribe(listener) {\r\n    this._listeners.add(listener);\r\n    return () => this._listeners.remove(listener);\r\n  },\r\n\r\n  // Load / persist select state to localStorage\r\n  // Mutates state because `store.load()` should only be called once immediately after store is created, before any subscriptions.\r\n  load() {\r\n    const serializedData = localStorage.getItem(\"cm_fireworks_data\");\r\n    if (serializedData) {\r\n      const { schemaVersion, data } = JSON.parse(serializedData);\r\n\r\n      const config = this.state.config;\r\n      switch (schemaVersion) {\r\n        case \"1.1\":\r\n          config.quality = data.quality;\r\n          config.size = data.size;\r\n          config.skyLighting = data.skyLighting;\r\n          break;\r\n        case \"1.2\":\r\n          config.quality = data.quality;\r\n          config.size = data.size;\r\n          config.skyLighting = data.skyLighting;\r\n          config.scaleFactor = data.scaleFactor;\r\n          break;\r\n        default:\r\n          throw new Error(\"version switch should be exhaustive\");\r\n      }\r\n      console.log(`Loaded config (schema version ${schemaVersion})`);\r\n    }\r\n    // Deprecated data format. Checked with care (it's not namespaced).\r\n    else if (localStorage.getItem(\"schemaVersion\") === \"1\") {\r\n      let size;\r\n      // Attempt to parse data, ignoring if there is an error.\r\n      try {\r\n        const sizeRaw = localStorage.getItem(\"configSize\");\r\n        size = typeof sizeRaw === \"string\" && JSON.parse(sizeRaw);\r\n      } catch (e) {\r\n        console.log(\"Recovered from error parsing saved config:\");\r\n        console.error(e);\r\n        return;\r\n      }\r\n      // Only restore validated values\r\n      const sizeInt = parseInt(size, 10);\r\n      if (sizeInt >= 0 && sizeInt <= 4) {\r\n        this.state.config.size = String(sizeInt);\r\n      }\r\n    }\r\n  },\r\n\r\n  persist() {\r\n    const config = this.state.config;\r\n    localStorage.setItem(\r\n      \"cm_fireworks_data\",\r\n      JSON.stringify({\r\n        schemaVersion: \"1.2\",\r\n        data: {\r\n          quality: config.quality,\r\n          size: config.size,\r\n          skyLighting: config.skyLighting,\r\n          scaleFactor: config.scaleFactor,\r\n        },\r\n      })\r\n    );\r\n  },\r\n};\r\n\r\nif (!IS_HEADER) {\r\n  store.load();\r\n}\r\n\r\n// Actions\r\n// ---------\r\n\r\nfunction togglePause(toggle) {\r\n  const paused = store.state.paused;\r\n  let newValue;\r\n  if (typeof toggle === \"boolean\") {\r\n    newValue = toggle;\r\n  } else {\r\n    newValue = !paused;\r\n  }\r\n\r\n  if (paused !== newValue) {\r\n    store.setState({ paused: newValue });\r\n  }\r\n}\r\n\r\nfunction toggleSound(toggle) {\r\n  if (typeof toggle === \"boolean\") {\r\n    store.setState({ soundEnabled: toggle });\r\n  } else {\r\n    store.setState({ soundEnabled: !store.state.soundEnabled });\r\n  }\r\n}\r\n\r\nfunction toggleMenu(toggle) {\r\n  if (typeof toggle === \"boolean\") {\r\n    store.setState({ menuOpen: toggle });\r\n  } else {\r\n    store.setState({ menuOpen: !store.state.menuOpen });\r\n  }\r\n}\r\n\r\nfunction updateConfig(nextConfig) {\r\n  nextConfig = nextConfig || getConfigFromDOM();\r\n  store.setState({\r\n    config: Object.assign({}, store.state.config, nextConfig),\r\n  });\r\n\r\n  configDidUpdate();\r\n}\r\n\r\n// Map config to various properties & apply side effects\r\nfunction configDidUpdate() {\r\n  const config = store.state.config;\r\n\r\n  quality = qualitySelector();\r\n  isLowQuality = quality === QUALITY_LOW;\r\n  isNormalQuality = quality === QUALITY_NORMAL;\r\n  isHighQuality = quality === QUALITY_HIGH;\r\n\r\n  if (skyLightingSelector() === SKY_LIGHT_NONE) {\r\n    appNodes.canvasContainer.style.backgroundColor = \"#000\";\r\n  }\r\n\r\n  Spark.drawWidth = quality === QUALITY_HIGH ? 0.75 : 1;\r\n}\r\n\r\n// Selectors\r\n// -----------\r\n\r\nconst isRunning = (state = store.state) => !state.paused && !state.menuOpen;\r\n// Whether user has enabled sound.\r\nconst soundEnabledSelector = (state = store.state) => state.soundEnabled;\r\n// Whether any sounds are allowed, taking into account multiple factors.\r\nconst canPlaySoundSelector = (state = store.state) =>\r\n  isRunning(state) && soundEnabledSelector(state);\r\n// Convert quality to number.\r\nconst qualitySelector = () => +store.state.config.quality;\r\nconst shellNameSelector = () => store.state.config.shell;\r\n// Convert shell size to number.\r\nconst shellSizeSelector = () => +store.state.config.size;\r\nconst finaleSelector = () => store.state.config.finale;\r\nconst skyLightingSelector = () => +store.state.config.skyLighting;\r\nconst scaleFactorSelector = () => store.state.config.scaleFactor;\r\n\r\n// Help Content\r\nconst helpContent = {\r\n  shellType: {\r\n    header: \"烟花类型\",\r\n    body: \"你要放的烟花的类型，选择“随机（Random）”可以获得非常好的体验！\",\r\n  },\r\n  shellSize: {\r\n    header: \"烟花大小\",\r\n    body: \"烟花越大绽放范围就越大，但是烟花越大，设备所需的性能也会增多，大的烟花可能导致你的设备卡顿。\",\r\n  },\r\n  quality: {\r\n    header: \"画质\",\r\n    body: \"如果动画运行不流畅，你可以试试降低画质。画质越高，烟花绽放后的火花数量就越多，但高画质可能导致你的设备卡顿。\",\r\n  },\r\n  skyLighting: {\r\n    header: \"照亮天空\",\r\n    body: \"烟花爆炸时，背景会被照亮。如果你的屏幕看起来太亮了，可以把它改成“暗”或者“不”。\",\r\n  },\r\n  scaleFactor: {\r\n    header: \"缩放\",\r\n    body: \"使你与烟花离得更近或更远。对于较大的烟花，你可以选择更小的缩放值，尤其是在手机或平板电脑上。\",\r\n  },\r\n  autoLaunch: {\r\n    header: \"自动放烟花\",\r\n    body: \"开启后你就可以坐在你的设备屏幕前面欣赏烟花了，你也可以关闭它，但关闭后你就只能通过点击屏幕的方式来放烟花。\",\r\n  },\r\n  finaleMode: {\r\n    header: \"同时放更多的烟花\",\r\n    body: \"可以在同一时间自动放出更多的烟花（但需要开启先开启“自动放烟花”）。\",\r\n  },\r\n  hideControls: {\r\n    header: \"隐藏控制按钮\",\r\n    body: \"隐藏屏幕顶部的按钮。如果你要截图，或者需要一个无缝的体验，你就可以将按钮隐藏，隐藏按钮后你仍然可以在右上角打开设置。\",\r\n  },\r\n  fullscreen: {\r\n    header: \"全屏\",\r\n    body: \"切换至全屏模式\",\r\n  },\r\n  longExposure: {\r\n    header: \"保留烟花的火花\",\r\n    body: \"可以保留烟花留下的火花\",\r\n  },\r\n};\r\n\r\nconst nodeKeyToHelpKey = {\r\n  shellTypeLabel: \"shellType\",\r\n  shellSizeLabel: \"shellSize\",\r\n  qualityLabel: \"quality\",\r\n  skyLightingLabel: \"skyLighting\",\r\n  scaleFactorLabel: \"scaleFactor\",\r\n  autoLaunchLabel: \"autoLaunch\",\r\n  finaleModeLabel: \"finaleMode\",\r\n  hideControlsLabel: \"hideControls\",\r\n  fullscreenLabel: \"fullscreen\",\r\n  longExposureLabel: \"longExposure\",\r\n};\r\n\r\n// Render app UI / keep in sync with state\r\nconst appNodes = {\r\n  stageContainer: \".stage-container\",\r\n  canvasContainer: \".canvas-container\",\r\n  controls: \".controls\",\r\n  menu: \".menu\",\r\n  menuInnerWrap: \".menu__inner-wrap\",\r\n  pauseBtn: \".pause-btn\",\r\n  pauseBtnSVG: \".pause-btn use\",\r\n  soundBtn: \".sound-btn\",\r\n  soundBtnSVG: \".sound-btn use\",\r\n  shellType: \".shell-type\",\r\n  shellTypeLabel: \".shell-type-label\",\r\n  shellSize: \".shell-size\",\r\n  shellSizeLabel: \".shell-size-label\",\r\n  quality: \".quality-ui\",\r\n  qualityLabel: \".quality-ui-label\",\r\n  skyLighting: \".sky-lighting\",\r\n  skyLightingLabel: \".sky-lighting-label\",\r\n  scaleFactor: \".scaleFactor\",\r\n  scaleFactorLabel: \".scaleFactor-label\",\r\n  autoLaunch: \".auto-launch\",\r\n  autoLaunchLabel: \".auto-launch-label\",\r\n  finaleModeFormOption: \".form-option--finale-mode\",\r\n  finaleMode: \".finale-mode\",\r\n  finaleModeLabel: \".finale-mode-label\",\r\n  hideControls: \".hide-controls\",\r\n  hideControlsLabel: \".hide-controls-label\",\r\n  fullscreenFormOption: \".form-option--fullscreen\",\r\n  fullscreen: \".fullscreen\",\r\n  fullscreenLabel: \".fullscreen-label\",\r\n  longExposure: \".long-exposure\",\r\n  longExposureLabel: \".long-exposure-label\",\r\n\r\n  // Help UI\r\n  helpModal: \".help-modal\",\r\n  helpModalOverlay: \".help-modal__overlay\",\r\n  helpModalHeader: \".help-modal__header\",\r\n  helpModalBody: \".help-modal__body\",\r\n  helpModalCloseBtn: \".help-modal__close-btn\",\r\n};\r\n\r\n// Convert appNodes selectors to dom nodes\r\nObject.keys(appNodes).forEach((key) => {\r\n  appNodes[key] = document.querySelector(appNodes[key]);\r\n});\r\n\r\n// Remove fullscreen control if not supported.\r\nif (!fullscreenEnabled()) {\r\n  appNodes.fullscreenFormOption.classList.add(\"remove\");\r\n}\r\n\r\n// First render is called in init()\r\nfunction renderApp(state) {\r\n  const pauseBtnIcon = `#icon-${state.paused ? \"play\" : \"pause\"}`;\r\n  const soundBtnIcon = `#icon-sound-${soundEnabledSelector() ? \"on\" : \"off\"}`;\r\n  appNodes.pauseBtnSVG.setAttribute(\"href\", pauseBtnIcon);\r\n  appNodes.pauseBtnSVG.setAttribute(\"xlink:href\", pauseBtnIcon);\r\n  appNodes.soundBtnSVG.setAttribute(\"href\", soundBtnIcon);\r\n  appNodes.soundBtnSVG.setAttribute(\"xlink:href\", soundBtnIcon);\r\n  appNodes.controls.classList.toggle(\r\n    \"hide\",\r\n    state.menuOpen || state.config.hideControls\r\n  );\r\n  appNodes.canvasContainer.classList.toggle(\"blur\", state.menuOpen);\r\n  appNodes.menu.classList.toggle(\"hide\", !state.menuOpen);\r\n  appNodes.finaleModeFormOption.style.opacity = state.config.autoLaunch\r\n    ? 1\r\n    : 0.32;\r\n\r\n  appNodes.quality.value = state.config.quality;\r\n  appNodes.shellType.value = state.config.shell;\r\n  appNodes.shellSize.value = state.config.size;\r\n  appNodes.autoLaunch.checked = state.config.autoLaunch;\r\n  appNodes.finaleMode.checked = state.config.finale;\r\n  appNodes.skyLighting.value = state.config.skyLighting;\r\n  appNodes.hideControls.checked = state.config.hideControls;\r\n  appNodes.fullscreen.checked = state.fullscreen;\r\n  appNodes.longExposure.checked = state.config.longExposure;\r\n  appNodes.scaleFactor.value = state.config.scaleFactor.toFixed(2);\r\n\r\n  appNodes.menuInnerWrap.style.opacity = state.openHelpTopic ? 0.12 : 1;\r\n  appNodes.helpModal.classList.toggle(\"active\", !!state.openHelpTopic);\r\n  if (state.openHelpTopic) {\r\n    const { header, body } = helpContent[state.openHelpTopic];\r\n    appNodes.helpModalHeader.textContent = header;\r\n    appNodes.helpModalBody.textContent = body;\r\n  }\r\n}\r\n\r\nstore.subscribe(renderApp);\r\n\r\n// Perform side effects on state changes\r\nfunction handleStateChange(state, prevState) {\r\n  const canPlaySound = canPlaySoundSelector(state);\r\n  const canPlaySoundPrev = canPlaySoundSelector(prevState);\r\n\r\n  if (canPlaySound !== canPlaySoundPrev) {\r\n    if (canPlaySound) {\r\n      soundManager.resumeAll();\r\n    } else {\r\n      soundManager.pauseAll();\r\n    }\r\n  }\r\n}\r\n\r\nstore.subscribe(handleStateChange);\r\n\r\nfunction getConfigFromDOM() {\r\n  return {\r\n    quality: appNodes.quality.value,\r\n    shell: appNodes.shellType.value,\r\n    size: appNodes.shellSize.value,\r\n    autoLaunch: appNodes.autoLaunch.checked,\r\n    finale: appNodes.finaleMode.checked,\r\n    skyLighting: appNodes.skyLighting.value,\r\n    longExposure: appNodes.longExposure.checked,\r\n    hideControls: appNodes.hideControls.checked,\r\n    // Store value as number.\r\n    scaleFactor: parseFloat(appNodes.scaleFactor.value),\r\n  };\r\n}\r\n\r\nconst updateConfigNoEvent = () => updateConfig();\r\nappNodes.quality.addEventListener(\"input\", updateConfigNoEvent);\r\nappNodes.shellType.addEventListener(\"input\", updateConfigNoEvent);\r\nappNodes.shellSize.addEventListener(\"input\", updateConfigNoEvent);\r\nappNodes.autoLaunch.addEventListener(\"click\", () =>\r\n  setTimeout(updateConfig, 0)\r\n);\r\nappNodes.finaleMode.addEventListener(\"click\", () =>\r\n  setTimeout(updateConfig, 0)\r\n);\r\nappNodes.skyLighting.addEventListener(\"input\", updateConfigNoEvent);\r\nappNodes.longExposure.addEventListener(\"click\", () =>\r\n  setTimeout(updateConfig, 0)\r\n);\r\nappNodes.hideControls.addEventListener(\"click\", () =>\r\n  setTimeout(updateConfig, 0)\r\n);\r\nappNodes.fullscreen.addEventListener(\"click\", () =>\r\n  setTimeout(toggleFullscreen, 0)\r\n);\r\n// Changing scaleFactor requires triggering resize handling code as well.\r\nappNodes.scaleFactor.addEventListener(\"input\", () => {\r\n  updateConfig();\r\n  handleResize();\r\n});\r\n\r\nObject.keys(nodeKeyToHelpKey).forEach((nodeKey) => {\r\n  const helpKey = nodeKeyToHelpKey[nodeKey];\r\n  appNodes[nodeKey].addEventListener(\"click\", () => {\r\n    store.setState({ openHelpTopic: helpKey });\r\n  });\r\n});\r\n\r\nappNodes.helpModalCloseBtn.addEventListener(\"click\", () => {\r\n  store.setState({ openHelpTopic: null });\r\n});\r\n\r\nappNodes.helpModalOverlay.addEventListener(\"click\", () => {\r\n  store.setState({ openHelpTopic: null });\r\n});\r\n\r\n// Constant derivations\r\nconst COLOR_NAMES = Object.keys(COLOR);\r\nconst COLOR_CODES = COLOR_NAMES.map((colorName) => COLOR[colorName]);\r\n// Invisible stars need an indentifier, even through they won't be rendered - physics still apply.\r\nconst COLOR_CODES_W_INVIS = [...COLOR_CODES, INVISIBLE];\r\n// Map of color codes to their index in the array. Useful for quickly determining if a color has already been updated in a loop.\r\nconst COLOR_CODE_INDEXES = COLOR_CODES_W_INVIS.reduce((obj, code, i) => {\r\n  obj[code] = i;\r\n  return obj;\r\n}, {});\r\n// Tuples is a map keys by color codes (hex) with values of { r, g, b } tuples (still just objects).\r\nconst COLOR_TUPLES = {};\r\nCOLOR_CODES.forEach((hex) => {\r\n  COLOR_TUPLES[hex] = {\r\n    r: parseInt(hex.substr(1, 2), 16),\r\n    g: parseInt(hex.substr(3, 2), 16),\r\n    b: parseInt(hex.substr(5, 2), 16),\r\n  };\r\n});\r\n\r\n// Get a random color.\r\nfunction randomColorSimple() {\r\n  return COLOR_CODES[(Math.random() * COLOR_CODES.length) | 0];\r\n}\r\n\r\n// Get a random color, with some customization options available.\r\nlet lastColor;\r\nfunction randomColor(options) {\r\n  const notSame = options && options.notSame;\r\n  const notColor = options && options.notColor;\r\n  const limitWhite = options && options.limitWhite;\r\n  let color = randomColorSimple();\r\n\r\n  // limit the amount of white chosen randomly\r\n  if (limitWhite && color === COLOR.White && Math.random() < 0.6) {\r\n    color = randomColorSimple();\r\n  }\r\n\r\n  if (notSame) {\r\n    while (color === lastColor) {\r\n      color = randomColorSimple();\r\n    }\r\n  } else if (notColor) {\r\n    while (color === notColor) {\r\n      color = randomColorSimple();\r\n    }\r\n  }\r\n\r\n  lastColor = color;\r\n  return color;\r\n}\r\n\r\nfunction whiteOrGold() {\r\n  return Math.random() < 0.5 ? COLOR.Gold : COLOR.White;\r\n}\r\n\r\n// Shell helpers\r\nfunction makePistilColor(shellColor) {\r\n  return shellColor === COLOR.White || shellColor === COLOR.Gold\r\n    ? randomColor({ notColor: shellColor })\r\n    : whiteOrGold();\r\n}\r\n\r\n// Unique shell types\r\nconst crysanthemumShell = (size = 1) => {\r\n  const glitter = Math.random() < 0.25;\r\n  const singleColor = Math.random() < 0.72;\r\n  const color = singleColor\r\n    ? randomColor({ limitWhite: true })\r\n    : [randomColor(), randomColor({ notSame: true })];\r\n  const pistil = singleColor && Math.random() < 0.42;\r\n  const pistilColor = pistil && makePistilColor(color);\r\n  const secondColor =\r\n    singleColor && (Math.random() < 0.2 || color === COLOR.White)\r\n      ? pistilColor || randomColor({ notColor: color, limitWhite: true })\r\n      : null;\r\n  const streamers = !pistil && color !== COLOR.White && Math.random() < 0.42;\r\n  let starDensity = glitter ? 1.1 : 1.25;\r\n  if (isLowQuality) starDensity *= 0.8;\r\n  if (isHighQuality) starDensity = 1.2;\r\n  return {\r\n    shellSize: size,\r\n    spreadSize: 300 + size * 100,\r\n    starLife: 900 + size * 200,\r\n    starDensity,\r\n    color,\r\n    secondColor,\r\n    glitter: glitter ? \"light\" : \"\",\r\n    glitterColor: whiteOrGold(),\r\n    pistil,\r\n    pistilColor,\r\n    streamers,\r\n  };\r\n};\r\n\r\nconst ghostShell = (size = 1) => {\r\n  // Extend crysanthemum shell\r\n  const shell = crysanthemumShell(size);\r\n  // Ghost effect can be fast, so extend star life\r\n  shell.starLife *= 1.5;\r\n  // Ensure we always have a single color other than white\r\n  let ghostColor = randomColor({ notColor: COLOR.White });\r\n  // Always use streamers, and sometimes a pistil\r\n  shell.streamers = true;\r\n  const pistil = Math.random() < 0.42;\r\n  const pistilColor = pistil && makePistilColor(ghostColor);\r\n  // Ghost effect - transition from invisible to chosen color\r\n  shell.color = INVISIBLE;\r\n  shell.secondColor = ghostColor;\r\n  // We don't want glitter to be spewed by invisible stars, and we don't currently\r\n  // have a way to transition glitter state. So we'll disable it.\r\n  shell.glitter = \"\";\r\n\r\n  return shell;\r\n};\r\n\r\nconst strobeShell = (size = 1) => {\r\n  const color = randomColor({ limitWhite: true });\r\n  return {\r\n    shellSize: size,\r\n    spreadSize: 280 + size * 92,\r\n    starLife: 1100 + size * 200,\r\n    starLifeVariation: 0.4,\r\n    starDensity: 1.1,\r\n    color,\r\n    glitter: \"light\",\r\n    glitterColor: COLOR.White,\r\n    strobe: true,\r\n    strobeColor: Math.random() < 0.5 ? COLOR.White : null,\r\n    pistil: Math.random() < 0.5,\r\n    pistilColor: makePistilColor(color),\r\n  };\r\n};\r\n\r\nconst palmShell = (size = 1) => {\r\n  const color = randomColor();\r\n  const thick = Math.random() < 0.5;\r\n  return {\r\n    shellSize: size,\r\n    color,\r\n    spreadSize: 250 + size * 75,\r\n    starDensity: thick ? 0.15 : 0.4,\r\n    starLife: 1800 + size * 200,\r\n    glitter: thick ? \"thick\" : \"heavy\",\r\n  };\r\n};\r\n\r\nconst ringShell = (size = 1) => {\r\n  const color = randomColor();\r\n  const pistil = Math.random() < 0.75;\r\n  return {\r\n    shellSize: size,\r\n    ring: true,\r\n    color,\r\n    spreadSize: 300 + size * 100,\r\n    starLife: 900 + size * 200,\r\n    starCount: 2.2 * PI_2 * (size + 1),\r\n    pistil,\r\n    pistilColor: makePistilColor(color),\r\n    glitter: !pistil ? \"light\" : \"\",\r\n    glitterColor: color === COLOR.Gold ? COLOR.Gold : COLOR.White,\r\n    streamers: Math.random() < 0.3,\r\n  };\r\n  // return Object.assign({}, defaultShell, config);\r\n};\r\n\r\nconst crossetteShell = (size = 1) => {\r\n  const color = randomColor({ limitWhite: true });\r\n  return {\r\n    shellSize: size,\r\n    spreadSize: 300 + size * 100,\r\n    starLife: 750 + size * 160,\r\n    starLifeVariation: 0.4,\r\n    starDensity: 0.85,\r\n    color,\r\n    crossette: true,\r\n    pistil: Math.random() < 0.5,\r\n    pistilColor: makePistilColor(color),\r\n  };\r\n};\r\n\r\nconst floralShell = (size = 1) => ({\r\n  shellSize: size,\r\n  spreadSize: 300 + size * 120,\r\n  starDensity: 0.12,\r\n  starLife: 500 + size * 50,\r\n  starLifeVariation: 0.5,\r\n  color:\r\n    Math.random() < 0.65\r\n      ? \"random\"\r\n      : Math.random() < 0.15\r\n      ? randomColor()\r\n      : [randomColor(), randomColor({ notSame: true })],\r\n  floral: true,\r\n});\r\n\r\nconst fallingLeavesShell = (size = 1) => ({\r\n  shellSize: size,\r\n  color: INVISIBLE,\r\n  spreadSize: 300 + size * 120,\r\n  starDensity: 0.12,\r\n  starLife: 500 + size * 50,\r\n  starLifeVariation: 0.5,\r\n  glitter: \"medium\",\r\n  glitterColor: COLOR.Gold,\r\n  fallingLeaves: true,\r\n});\r\n\r\nconst willowShell = (size = 1) => ({\r\n  shellSize: size,\r\n  spreadSize: 300 + size * 100,\r\n  starDensity: 0.6,\r\n  starLife: 3000 + size * 300,\r\n  glitter: \"willow\",\r\n  glitterColor: COLOR.Gold,\r\n  color: INVISIBLE,\r\n});\r\n\r\nconst crackleShell = (size = 1) => {\r\n  // favor gold\r\n  const color = Math.random() < 0.75 ? COLOR.Gold : randomColor();\r\n  return {\r\n    shellSize: size,\r\n    spreadSize: 380 + size * 75,\r\n    starDensity: isLowQuality ? 0.65 : 1,\r\n    starLife: 600 + size * 100,\r\n    starLifeVariation: 0.32,\r\n    glitter: \"light\",\r\n    glitterColor: COLOR.Gold,\r\n    color,\r\n    crackle: true,\r\n    pistil: Math.random() < 0.65,\r\n    pistilColor: makePistilColor(color),\r\n  };\r\n};\r\n\r\nconst horsetailShell = (size = 1) => {\r\n  const color = randomColor();\r\n  return {\r\n    shellSize: size,\r\n    horsetail: true,\r\n    color,\r\n    spreadSize: 250 + size * 38,\r\n    starDensity: 0.9,\r\n    starLife: 2500 + size * 300,\r\n    glitter: \"medium\",\r\n    glitterColor: Math.random() < 0.5 ? whiteOrGold() : color,\r\n    // Add strobe effect to white horsetails, to make them more interesting\r\n    strobe: color === COLOR.White,\r\n  };\r\n};\r\n\r\nfunction randomShellName() {\r\n  return Math.random() < 0.5\r\n    ? \"Crysanthemum\"\r\n    : shellNames[(Math.random() * (shellNames.length - 1) + 1) | 0];\r\n}\r\n\r\nfunction randomShell(size) {\r\n  // Special selection for codepen header.\r\n  if (IS_HEADER) return randomFastShell()(size);\r\n  // Normal operation\r\n  return shellTypes[randomShellName()](size);\r\n}\r\n\r\nfunction shellFromConfig(size) {\r\n  return shellTypes[shellNameSelector()](size);\r\n}\r\n\r\n// Get a random shell, not including processing intensive varients\r\n// Note this is only random when \"Random\" shell is selected in config.\r\n// Also, this does not create the shell, only returns the factory function.\r\nconst fastShellBlacklist = [\"Falling Leaves\", \"Floral\", \"Willow\"];\r\nfunction randomFastShell() {\r\n  const isRandom = shellNameSelector() === \"Random\";\r\n  let shellName = isRandom ? randomShellName() : shellNameSelector();\r\n  if (isRandom) {\r\n    while (fastShellBlacklist.includes(shellName)) {\r\n      shellName = randomShellName();\r\n    }\r\n  }\r\n  return shellTypes[shellName];\r\n}\r\n\r\nconst shellTypes = {\r\n  Random: randomShell,\r\n  Crackle: crackleShell,\r\n  Crossette: crossetteShell,\r\n  Crysanthemum: crysanthemumShell,\r\n  \"Falling Leaves\": fallingLeavesShell,\r\n  Floral: floralShell,\r\n  Ghost: ghostShell,\r\n  \"Horse Tail\": horsetailShell,\r\n  Palm: palmShell,\r\n  Ring: ringShell,\r\n  Strobe: strobeShell,\r\n  Willow: willowShell,\r\n};\r\n\r\nconst shellNames = Object.keys(shellTypes);\r\n\r\nfunction init() {\r\n  // Remove loading state\r\n  document.querySelector(\".loading-init\").remove();\r\n  appNodes.stageContainer.classList.remove(\"remove\");\r\n\r\n  // Populate dropdowns\r\n  function setOptionsForSelect(node, options) {\r\n    node.innerHTML = options.reduce(\r\n      (acc, opt) =>\r\n        (acc += `<option value=\"${opt.value}\">${opt.label}</option>`),\r\n      \"\"\r\n    );\r\n  }\r\n\r\n  // shell type\r\n  let options = \"\";\r\n  shellNames.forEach(\r\n    (opt) => (options += `<option value=\"${opt}\">${opt}</option>`)\r\n  );\r\n  appNodes.shellType.innerHTML = options;\r\n  // shell size\r\n  options = \"\";\r\n  ['3\"', '4\"', '6\"', '8\"', '12\"', '16\"'].forEach(\r\n    (opt, i) => (options += `<option value=\"${i}\">${opt}</option>`)\r\n  );\r\n  appNodes.shellSize.innerHTML = options;\r\n\r\n  setOptionsForSelect(appNodes.quality, [\r\n    { label: \"低\", value: QUALITY_LOW },\r\n    { label: \"正常\", value: QUALITY_NORMAL },\r\n    { label: \"高\", value: QUALITY_HIGH },\r\n  ]);\r\n\r\n  setOptionsForSelect(appNodes.skyLighting, [\r\n    { label: \"不\", value: SKY_LIGHT_NONE },\r\n    { label: \"暗\", value: SKY_LIGHT_DIM },\r\n    { label: \"正常\", value: SKY_LIGHT_NORMAL },\r\n  ]);\r\n\r\n  // 0.9 is mobile default\r\n  setOptionsForSelect(\r\n    appNodes.scaleFactor,\r\n    [0.5, 0.62, 0.75, 0.9, 1.0, 1.5, 2.0].map((value) => ({\r\n      value: value.toFixed(2),\r\n      label: `${value * 100}%`,\r\n    }))\r\n  );\r\n\r\n  // Begin simulation\r\n  togglePause(false);\r\n\r\n  // initial render\r\n  renderApp(store.state);\r\n\r\n  // Apply initial config\r\n  configDidUpdate();\r\n}\r\n\r\nfunction fitShellPositionInBoundsH(position) {\r\n  const edge = 0.18;\r\n  return (1 - edge * 2) * position + edge;\r\n}\r\n\r\nfunction fitShellPositionInBoundsV(position) {\r\n  return position * 0.75;\r\n}\r\n\r\nfunction getRandomShellPositionH() {\r\n  return fitShellPositionInBoundsH(Math.random());\r\n}\r\n\r\nfunction getRandomShellPositionV() {\r\n  return fitShellPositionInBoundsV(Math.random());\r\n}\r\n\r\nfunction getRandomShellSize() {\r\n  const baseSize = shellSizeSelector();\r\n  const maxVariance = Math.min(2.5, baseSize);\r\n  const variance = Math.random() * maxVariance;\r\n  const size = baseSize - variance;\r\n  const height = maxVariance === 0 ? Math.random() : 1 - variance / maxVariance;\r\n  const centerOffset = Math.random() * (1 - height * 0.65) * 0.5;\r\n  const x = Math.random() < 0.5 ? 0.5 - centerOffset : 0.5 + centerOffset;\r\n  return {\r\n    size,\r\n    x: fitShellPositionInBoundsH(x),\r\n    height: fitShellPositionInBoundsV(height),\r\n  };\r\n}\r\n\r\n// Launches a shell from a user pointer event, based on state.config\r\nfunction launchShellFromConfig(event) {\r\n  const shell = new Shell(shellFromConfig(shellSizeSelector()));\r\n  const w = mainStage.width;\r\n  const h = mainStage.height;\r\n\r\n  shell.launch(\r\n    event ? event.x / w : getRandomShellPositionH(),\r\n    event ? 1 - event.y / h : getRandomShellPositionV()\r\n  );\r\n}\r\n\r\n// Sequences\r\n// -----------\r\n\r\nfunction seqRandomShell() {\r\n  const size = getRandomShellSize();\r\n  const shell = new Shell(shellFromConfig(size.size));\r\n  shell.launch(size.x, size.height);\r\n\r\n  let extraDelay = shell.starLife;\r\n  if (shell.fallingLeaves) {\r\n    extraDelay = 4600;\r\n  }\r\n\r\n  return 900 + Math.random() * 600 + extraDelay;\r\n}\r\n\r\nfunction seqRandomFastShell() {\r\n  const shellType = randomFastShell();\r\n  const size = getRandomShellSize();\r\n  const shell = new Shell(shellType(size.size));\r\n  shell.launch(size.x, size.height);\r\n\r\n  let extraDelay = shell.starLife;\r\n\r\n  return 900 + Math.random() * 600 + extraDelay;\r\n}\r\n\r\nfunction seqTwoRandom() {\r\n  const size1 = getRandomShellSize();\r\n  const size2 = getRandomShellSize();\r\n  const shell1 = new Shell(shellFromConfig(size1.size));\r\n  const shell2 = new Shell(shellFromConfig(size2.size));\r\n  const leftOffset = Math.random() * 0.2 - 0.1;\r\n  const rightOffset = Math.random() * 0.2 - 0.1;\r\n  shell1.launch(0.3 + leftOffset, size1.height);\r\n  setTimeout(() => {\r\n    shell2.launch(0.7 + rightOffset, size2.height);\r\n  }, 100);\r\n\r\n  let extraDelay = Math.max(shell1.starLife, shell2.starLife);\r\n  if (shell1.fallingLeaves || shell2.fallingLeaves) {\r\n    extraDelay = 4600;\r\n  }\r\n\r\n  return 900 + Math.random() * 600 + extraDelay;\r\n}\r\n\r\nfunction seqTriple() {\r\n  const shellType = randomFastShell();\r\n  const baseSize = shellSizeSelector();\r\n  const smallSize = Math.max(0, baseSize - 1.25);\r\n\r\n  const offset = Math.random() * 0.08 - 0.04;\r\n  const shell1 = new Shell(shellType(baseSize));\r\n  shell1.launch(0.5 + offset, 0.7);\r\n\r\n  const leftDelay = 1000 + Math.random() * 400;\r\n  const rightDelay = 1000 + Math.random() * 400;\r\n\r\n  setTimeout(() => {\r\n    const offset = Math.random() * 0.08 - 0.04;\r\n    const shell2 = new Shell(shellType(smallSize));\r\n    shell2.launch(0.2 + offset, 0.1);\r\n  }, leftDelay);\r\n\r\n  setTimeout(() => {\r\n    const offset = Math.random() * 0.08 - 0.04;\r\n    const shell3 = new Shell(shellType(smallSize));\r\n    shell3.launch(0.8 + offset, 0.1);\r\n  }, rightDelay);\r\n\r\n  return 4000;\r\n}\r\n\r\nfunction seqPyramid() {\r\n  const barrageCountHalf = IS_DESKTOP ? 7 : 4;\r\n  const largeSize = shellSizeSelector();\r\n  const smallSize = Math.max(0, largeSize - 3);\r\n  const randomMainShell = Math.random() < 0.78 ? crysanthemumShell : ringShell;\r\n  const randomSpecialShell = randomShell;\r\n\r\n  function launchShell(x, useSpecial) {\r\n    const isRandom = shellNameSelector() === \"Random\";\r\n    let shellType = isRandom\r\n      ? useSpecial\r\n        ? randomSpecialShell\r\n        : randomMainShell\r\n      : shellTypes[shellNameSelector()];\r\n    const shell = new Shell(shellType(useSpecial ? largeSize : smallSize));\r\n    const height = x <= 0.5 ? x / 0.5 : (1 - x) / 0.5;\r\n    shell.launch(x, useSpecial ? 0.75 : height * 0.42);\r\n  }\r\n\r\n  let count = 0;\r\n  let delay = 0;\r\n  while (count <= barrageCountHalf) {\r\n    if (count === barrageCountHalf) {\r\n      setTimeout(() => {\r\n        launchShell(0.5, true);\r\n      }, delay);\r\n    } else {\r\n      const offset = (count / barrageCountHalf) * 0.5;\r\n      const delayOffset = Math.random() * 30 + 30;\r\n      setTimeout(() => {\r\n        launchShell(offset, false);\r\n      }, delay);\r\n      setTimeout(() => {\r\n        launchShell(1 - offset, false);\r\n      }, delay + delayOffset);\r\n    }\r\n\r\n    count++;\r\n    delay += 200;\r\n  }\r\n\r\n  return 3400 + barrageCountHalf * 250;\r\n}\r\n\r\nfunction seqSmallBarrage() {\r\n  seqSmallBarrage.lastCalled = Date.now();\r\n  const barrageCount = IS_DESKTOP ? 11 : 5;\r\n  const specialIndex = IS_DESKTOP ? 3 : 1;\r\n  const shellSize = Math.max(0, shellSizeSelector() - 2);\r\n  const randomMainShell = Math.random() < 0.78 ? crysanthemumShell : ringShell;\r\n  const randomSpecialShell = randomFastShell();\r\n\r\n  // (cos(x*5π+0.5π)+1)/2 is a custom wave bounded by 0 and 1 used to set varying launch heights\r\n  function launchShell(x, useSpecial) {\r\n    const isRandom = shellNameSelector() === \"Random\";\r\n    let shellType = isRandom\r\n      ? useSpecial\r\n        ? randomSpecialShell\r\n        : randomMainShell\r\n      : shellTypes[shellNameSelector()];\r\n    const shell = new Shell(shellType(shellSize));\r\n    const height = (Math.cos(x * 5 * Math.PI + PI_HALF) + 1) / 2;\r\n    shell.launch(x, height * 0.75);\r\n  }\r\n\r\n  let count = 0;\r\n  let delay = 0;\r\n  while (count < barrageCount) {\r\n    if (count === 0) {\r\n      launchShell(0.5, false);\r\n      count += 1;\r\n    } else {\r\n      const offset = (count + 1) / barrageCount / 2;\r\n      const delayOffset = Math.random() * 30 + 30;\r\n      const useSpecial = count === specialIndex;\r\n      setTimeout(() => {\r\n        launchShell(0.5 + offset, useSpecial);\r\n      }, delay);\r\n      setTimeout(() => {\r\n        launchShell(0.5 - offset, useSpecial);\r\n      }, delay + delayOffset);\r\n      count += 2;\r\n    }\r\n    delay += 200;\r\n  }\r\n\r\n  return 3400 + barrageCount * 120;\r\n}\r\nseqSmallBarrage.cooldown = 15000;\r\nseqSmallBarrage.lastCalled = Date.now();\r\n\r\nconst sequences = [\r\n  seqRandomShell,\r\n  seqTwoRandom,\r\n  seqTriple,\r\n  seqPyramid,\r\n  seqSmallBarrage,\r\n];\r\n\r\nlet isFirstSeq = true;\r\nconst finaleCount = 32;\r\nlet currentFinaleCount = 0;\r\nfunction startSequence() {\r\n  if (isFirstSeq) {\r\n    isFirstSeq = false;\r\n    if (IS_HEADER) {\r\n      return seqTwoRandom();\r\n    } else {\r\n      const shell = new Shell(crysanthemumShell(shellSizeSelector()));\r\n      shell.launch(0.5, 0.5);\r\n      return 2400;\r\n    }\r\n  }\r\n\r\n  if (finaleSelector()) {\r\n    seqRandomFastShell();\r\n    if (currentFinaleCount < finaleCount) {\r\n      currentFinaleCount++;\r\n      return 170;\r\n    } else {\r\n      currentFinaleCount = 0;\r\n      return 6000;\r\n    }\r\n  }\r\n\r\n  const rand = Math.random();\r\n\r\n  if (\r\n    rand < 0.08 &&\r\n    Date.now() - seqSmallBarrage.lastCalled > seqSmallBarrage.cooldown\r\n  ) {\r\n    return seqSmallBarrage();\r\n  }\r\n\r\n  if (rand < 0.1) {\r\n    return seqPyramid();\r\n  }\r\n\r\n  if (rand < 0.6 && !IS_HEADER) {\r\n    return seqRandomShell();\r\n  } else if (rand < 0.8) {\r\n    return seqTwoRandom();\r\n  } else if (rand < 1) {\r\n    return seqTriple();\r\n  }\r\n}\r\n\r\nlet activePointerCount = 0;\r\nlet isUpdatingSpeed = false;\r\n\r\nfunction handlePointerStart(event) {\r\n  activePointerCount++;\r\n  const btnSize = 50;\r\n\r\n  if (event.y < btnSize) {\r\n    if (event.x < btnSize) {\r\n      togglePause();\r\n      return;\r\n    }\r\n    if (\r\n      event.x > mainStage.width / 2 - btnSize / 2 &&\r\n      event.x < mainStage.width / 2 + btnSize / 2\r\n    ) {\r\n      toggleSound();\r\n      return;\r\n    }\r\n    if (event.x > mainStage.width - btnSize) {\r\n      toggleMenu();\r\n      return;\r\n    }\r\n  }\r\n\r\n  if (!isRunning()) return;\r\n\r\n  if (updateSpeedFromEvent(event)) {\r\n    isUpdatingSpeed = true;\r\n  } else if (event.onCanvas) {\r\n    launchShellFromConfig(event);\r\n  }\r\n}\r\n\r\nfunction handlePointerEnd(event) {\r\n  activePointerCount--;\r\n  isUpdatingSpeed = false;\r\n}\r\n\r\nfunction handlePointerMove(event) {\r\n  if (!isRunning()) return;\r\n\r\n  if (isUpdatingSpeed) {\r\n    updateSpeedFromEvent(event);\r\n  }\r\n}\r\n\r\nfunction handleKeydown(event) {\r\n  // P\r\n  if (event.keyCode === 80) {\r\n    togglePause();\r\n  }\r\n  // O\r\n  else if (event.keyCode === 79) {\r\n    toggleMenu();\r\n  }\r\n  // Esc\r\n  else if (event.keyCode === 27) {\r\n    toggleMenu(false);\r\n  }\r\n}\r\n\r\nmainStage.addEventListener(\"pointerstart\", handlePointerStart);\r\nmainStage.addEventListener(\"pointerend\", handlePointerEnd);\r\nmainStage.addEventListener(\"pointermove\", handlePointerMove);\r\nwindow.addEventListener(\"keydown\", handleKeydown);\r\n\r\n// Account for window resize and custom scale changes.\r\nfunction handleResize() {\r\n  const w = window.innerWidth;\r\n  const h = window.innerHeight;\r\n  // Try to adopt screen size, heeding maximum sizes specified\r\n  const containerW = Math.min(w, MAX_WIDTH);\r\n  // On small screens, use full device height\r\n  const containerH = w <= 420 ? h : Math.min(h, MAX_HEIGHT);\r\n  appNodes.stageContainer.style.width = containerW + \"px\";\r\n  appNodes.stageContainer.style.height = containerH + \"px\";\r\n  stages.forEach((stage) => stage.resize(containerW, containerH));\r\n  // Account for scale\r\n  const scaleFactor = scaleFactorSelector();\r\n  stageW = containerW / scaleFactor;\r\n  stageH = containerH / scaleFactor;\r\n}\r\n\r\n// Compute initial dimensions\r\nhandleResize();\r\n\r\nwindow.addEventListener(\"resize\", handleResize);\r\n\r\n// Dynamic globals\r\nlet currentFrame = 0;\r\nlet speedBarOpacity = 0;\r\nlet autoLaunchTime = 0;\r\n\r\nfunction updateSpeedFromEvent(event) {\r\n  if (isUpdatingSpeed || event.y >= mainStage.height - 44) {\r\n    // On phones it's hard to hit the edge pixels in order to set speed at 0 or 1, so some padding is provided to make that easier.\r\n    const edge = 16;\r\n    const newSpeed = (event.x - edge) / (mainStage.width - edge * 2);\r\n    simSpeed = Math.min(Math.max(newSpeed, 0), 1);\r\n    // show speed bar after an update\r\n    speedBarOpacity = 1;\r\n    // If we updated the speed, return true\r\n    return true;\r\n  }\r\n  // Return false if the speed wasn't updated\r\n  return false;\r\n}\r\n\r\n// Extracted function to keep `update()` optimized\r\nfunction updateGlobals(timeStep, lag) {\r\n  currentFrame++;\r\n\r\n  // Always try to fade out speed bar\r\n  if (!isUpdatingSpeed) {\r\n    speedBarOpacity -= lag / 30; // half a second\r\n    if (speedBarOpacity < 0) {\r\n      speedBarOpacity = 0;\r\n    }\r\n  }\r\n\r\n  // auto launch shells\r\n  if (store.state.config.autoLaunch) {\r\n    autoLaunchTime -= timeStep;\r\n    if (autoLaunchTime <= 0) {\r\n      autoLaunchTime = startSequence() * 1.25;\r\n    }\r\n  }\r\n}\r\n\r\nfunction update(frameTime, lag) {\r\n  if (!isRunning()) return;\r\n\r\n  const width = stageW;\r\n  const height = stageH;\r\n  const timeStep = frameTime * simSpeed;\r\n  const speed = simSpeed * lag;\r\n\r\n  updateGlobals(timeStep, lag);\r\n\r\n  const starDrag = 1 - (1 - Star.airDrag) * speed;\r\n  const starDragHeavy = 1 - (1 - Star.airDragHeavy) * speed;\r\n  const sparkDrag = 1 - (1 - Spark.airDrag) * speed;\r\n  const gAcc = (timeStep / 1000) * GRAVITY;\r\n  COLOR_CODES_W_INVIS.forEach((color) => {\r\n    // Stars\r\n    const stars = Star.active[color];\r\n    for (let i = stars.length - 1; i >= 0; i = i - 1) {\r\n      const star = stars[i];\r\n      // Only update each star once per frame. Since color can change, it's possible a star could update twice without this, leading to a \"jump\".\r\n      if (star.updateFrame === currentFrame) {\r\n        continue;\r\n      }\r\n      star.updateFrame = currentFrame;\r\n\r\n      star.life -= timeStep;\r\n      if (star.life <= 0) {\r\n        stars.splice(i, 1);\r\n        Star.returnInstance(star);\r\n      } else {\r\n        const burnRate = Math.pow(star.life / star.fullLife, 0.5);\r\n        const burnRateInverse = 1 - burnRate;\r\n\r\n        star.prevX = star.x;\r\n        star.prevY = star.y;\r\n        star.x += star.speedX * speed;\r\n        star.y += star.speedY * speed;\r\n        // Apply air drag if star isn't \"heavy\". The heavy property is used for the shell comets.\r\n        if (!star.heavy) {\r\n          star.speedX *= starDrag;\r\n          star.speedY *= starDrag;\r\n        } else {\r\n          star.speedX *= starDragHeavy;\r\n          star.speedY *= starDragHeavy;\r\n        }\r\n        star.speedY += gAcc;\r\n\r\n        if (star.spinRadius) {\r\n          star.spinAngle += star.spinSpeed * speed;\r\n          star.x += Math.sin(star.spinAngle) * star.spinRadius * speed;\r\n          star.y += Math.cos(star.spinAngle) * star.spinRadius * speed;\r\n        }\r\n\r\n        if (star.sparkFreq) {\r\n          star.sparkTimer -= timeStep;\r\n          while (star.sparkTimer < 0) {\r\n            star.sparkTimer +=\r\n              star.sparkFreq * 0.75 + star.sparkFreq * burnRateInverse * 4;\r\n            Spark.add(\r\n              star.x,\r\n              star.y,\r\n              star.sparkColor,\r\n              Math.random() * PI_2,\r\n              Math.random() * star.sparkSpeed * burnRate,\r\n              star.sparkLife * 0.8 +\r\n                Math.random() * star.sparkLifeVariation * star.sparkLife\r\n            );\r\n          }\r\n        }\r\n\r\n        // Handle star transitions\r\n        if (star.life < star.transitionTime) {\r\n          if (star.secondColor && !star.colorChanged) {\r\n            star.colorChanged = true;\r\n            star.color = star.secondColor;\r\n            stars.splice(i, 1);\r\n            Star.active[star.secondColor].push(star);\r\n            if (star.secondColor === INVISIBLE) {\r\n              star.sparkFreq = 0;\r\n            }\r\n          }\r\n\r\n          if (star.strobe) {\r\n            // Strobes in the following pattern: on:off:off:on:off:off in increments of `strobeFreq` ms.\r\n            star.visible = Math.floor(star.life / star.strobeFreq) % 3 === 0;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    // Sparks\r\n    const sparks = Spark.active[color];\r\n    for (let i = sparks.length - 1; i >= 0; i = i - 1) {\r\n      const spark = sparks[i];\r\n      spark.life -= timeStep;\r\n      if (spark.life <= 0) {\r\n        sparks.splice(i, 1);\r\n        Spark.returnInstance(spark);\r\n      } else {\r\n        spark.prevX = spark.x;\r\n        spark.prevY = spark.y;\r\n        spark.x += spark.speedX * speed;\r\n        spark.y += spark.speedY * speed;\r\n        spark.speedX *= sparkDrag;\r\n        spark.speedY *= sparkDrag;\r\n        spark.speedY += gAcc;\r\n      }\r\n    }\r\n  });\r\n\r\n  render(speed);\r\n}\r\n\r\nfunction render(speed) {\r\n  const { dpr } = mainStage;\r\n  const width = stageW;\r\n  const height = stageH;\r\n  const trailsCtx = trailsStage.ctx;\r\n  const mainCtx = mainStage.ctx;\r\n\r\n  if (skyLightingSelector() !== SKY_LIGHT_NONE) {\r\n    colorSky(speed);\r\n  }\r\n\r\n  // Account for high DPI screens, and custom scale factor.\r\n  const scaleFactor = scaleFactorSelector();\r\n  trailsCtx.scale(dpr * scaleFactor, dpr * scaleFactor);\r\n  mainCtx.scale(dpr * scaleFactor, dpr * scaleFactor);\r\n\r\n  trailsCtx.globalCompositeOperation = \"source-over\";\r\n  trailsCtx.fillStyle = `rgba(0, 0, 0, ${\r\n    store.state.config.longExposure ? 0.0025 : 0.175 * speed\r\n  })`;\r\n  trailsCtx.fillRect(0, 0, width, height);\r\n\r\n  mainCtx.clearRect(0, 0, width, height);\r\n\r\n  // Draw queued burst flashes\r\n  // These must also be drawn using source-over due to Safari. Seems rendering the gradients using lighten draws large black boxes instead.\r\n  // Thankfully, these burst flashes look pretty much the same either way.\r\n  // The language of this project was translated into Chinese by Nianbroken\r\n  while (BurstFlash.active.length) {\r\n    const bf = BurstFlash.active.pop();\r\n\r\n    const burstGradient = trailsCtx.createRadialGradient(\r\n      bf.x,\r\n      bf.y,\r\n      0,\r\n      bf.x,\r\n      bf.y,\r\n      bf.radius\r\n    );\r\n    burstGradient.addColorStop(0.024, \"rgba(255, 255, 255, 1)\");\r\n    burstGradient.addColorStop(0.125, \"rgba(255, 160, 20, 0.2)\");\r\n    burstGradient.addColorStop(0.32, \"rgba(255, 140, 20, 0.11)\");\r\n    burstGradient.addColorStop(1, \"rgba(255, 120, 20, 0)\");\r\n    trailsCtx.fillStyle = burstGradient;\r\n    trailsCtx.fillRect(\r\n      bf.x - bf.radius,\r\n      bf.y - bf.radius,\r\n      bf.radius * 2,\r\n      bf.radius * 2\r\n    );\r\n\r\n    BurstFlash.returnInstance(bf);\r\n  }\r\n\r\n  // Remaining drawing on trails canvas will use 'lighten' blend mode\r\n  trailsCtx.globalCompositeOperation = \"lighten\";\r\n\r\n  // Draw stars\r\n  trailsCtx.lineWidth = Star.drawWidth;\r\n  trailsCtx.lineCap = isLowQuality ? \"square\" : \"round\";\r\n  mainCtx.strokeStyle = \"#fff\";\r\n  mainCtx.lineWidth = 1;\r\n  mainCtx.beginPath();\r\n  COLOR_CODES.forEach((color) => {\r\n    const stars = Star.active[color];\r\n    trailsCtx.strokeStyle = color;\r\n    trailsCtx.beginPath();\r\n    stars.forEach((star) => {\r\n      if (star.visible) {\r\n        trailsCtx.moveTo(star.x, star.y);\r\n        trailsCtx.lineTo(star.prevX, star.prevY);\r\n        mainCtx.moveTo(star.x, star.y);\r\n        mainCtx.lineTo(star.x - star.speedX * 1.6, star.y - star.speedY * 1.6);\r\n      }\r\n    });\r\n    trailsCtx.stroke();\r\n  });\r\n  mainCtx.stroke();\r\n\r\n  // Draw sparks\r\n  trailsCtx.lineWidth = Spark.drawWidth;\r\n  trailsCtx.lineCap = \"butt\";\r\n  COLOR_CODES.forEach((color) => {\r\n    const sparks = Spark.active[color];\r\n    trailsCtx.strokeStyle = color;\r\n    trailsCtx.beginPath();\r\n    sparks.forEach((spark) => {\r\n      trailsCtx.moveTo(spark.x, spark.y);\r\n      trailsCtx.lineTo(spark.prevX, spark.prevY);\r\n    });\r\n    trailsCtx.stroke();\r\n  });\r\n\r\n  // Render speed bar if visible\r\n  if (speedBarOpacity) {\r\n    const speedBarHeight = 6;\r\n    mainCtx.globalAlpha = speedBarOpacity;\r\n    mainCtx.fillStyle = COLOR.Blue;\r\n    mainCtx.fillRect(\r\n      0,\r\n      height - speedBarHeight,\r\n      width * simSpeed,\r\n      speedBarHeight\r\n    );\r\n    mainCtx.globalAlpha = 1;\r\n  }\r\n\r\n  trailsCtx.setTransform(1, 0, 0, 1, 0, 0);\r\n  mainCtx.setTransform(1, 0, 0, 1, 0, 0);\r\n}\r\n\r\n// Draw colored overlay based on combined brightness of stars (light up the sky!)\r\n// Note: this is applied to the canvas container's background-color, so it's behind the particles\r\nconst currentSkyColor = { r: 0, g: 0, b: 0 };\r\nconst targetSkyColor = { r: 0, g: 0, b: 0 };\r\nfunction colorSky(speed) {\r\n  // The maximum r, g, or b value that will be used (255 would represent no maximum)\r\n  const maxSkySaturation = skyLightingSelector() * 15;\r\n  // How many stars are required in total to reach maximum sky brightness\r\n  const maxStarCount = 500;\r\n  let totalStarCount = 0;\r\n  // Initialize sky as black\r\n  targetSkyColor.r = 0;\r\n  targetSkyColor.g = 0;\r\n  targetSkyColor.b = 0;\r\n  // Add each known color to sky, multiplied by particle count of that color. This will put RGB values wildly out of bounds, but we'll scale them back later.\r\n  // Also add up total star count.\r\n  COLOR_CODES.forEach((color) => {\r\n    const tuple = COLOR_TUPLES[color];\r\n    const count = Star.active[color].length;\r\n    totalStarCount += count;\r\n    targetSkyColor.r += tuple.r * count;\r\n    targetSkyColor.g += tuple.g * count;\r\n    targetSkyColor.b += tuple.b * count;\r\n  });\r\n\r\n  // Clamp intensity at 1.0, and map to a custom non-linear curve. This allows few stars to perceivably light up the sky, while more stars continue to increase the brightness but at a lesser rate. This is more inline with humans' non-linear brightness perception.\r\n  const intensity = Math.pow(Math.min(1, totalStarCount / maxStarCount), 0.3);\r\n  // Figure out which color component has the highest value, so we can scale them without affecting the ratios.\r\n  // Prevent 0 from being used, so we don't divide by zero in the next step.\r\n  const maxColorComponent = Math.max(\r\n    1,\r\n    targetSkyColor.r,\r\n    targetSkyColor.g,\r\n    targetSkyColor.b\r\n  );\r\n  // Scale all color components to a max of `maxSkySaturation`, and apply intensity.\r\n  targetSkyColor.r =\r\n    (targetSkyColor.r / maxColorComponent) * maxSkySaturation * intensity;\r\n  targetSkyColor.g =\r\n    (targetSkyColor.g / maxColorComponent) * maxSkySaturation * intensity;\r\n  targetSkyColor.b =\r\n    (targetSkyColor.b / maxColorComponent) * maxSkySaturation * intensity;\r\n\r\n  // Animate changes to color to smooth out transitions.\r\n  const colorChange = 10;\r\n  currentSkyColor.r +=\r\n    ((targetSkyColor.r - currentSkyColor.r) / colorChange) * speed;\r\n  currentSkyColor.g +=\r\n    ((targetSkyColor.g - currentSkyColor.g) / colorChange) * speed;\r\n  currentSkyColor.b +=\r\n    ((targetSkyColor.b - currentSkyColor.b) / colorChange) * speed;\r\n\r\n  appNodes.canvasContainer.style.backgroundColor = `rgb(${\r\n    currentSkyColor.r | 0\r\n  }, ${currentSkyColor.g | 0}, ${currentSkyColor.b | 0})`;\r\n}\r\n\r\nmainStage.addEventListener(\"ticker\", update);\r\n\r\n// Helper used to semi-randomly spread particles over an arc\r\n// Values are flexible - `start` and `arcLength` can be negative, and `randomness` is simply a multiplier for random addition.\r\nfunction createParticleArc(\r\n  start,\r\n  arcLength,\r\n  count,\r\n  randomness,\r\n  particleFactory\r\n) {\r\n  const angleDelta = arcLength / count;\r\n  // Sometimes there is an extra particle at the end, too close to the start. Subtracting half the angleDelta ensures that is skipped.\r\n  // Would be nice to fix this a better way.\r\n  const end = start + arcLength - angleDelta * 0.5;\r\n\r\n  if (end > start) {\r\n    // Optimization: `angle=angle+angleDelta` vs. angle+=angleDelta\r\n    // V8 deoptimises with let compound assignment\r\n    for (let angle = start; angle < end; angle = angle + angleDelta) {\r\n      particleFactory(angle + Math.random() * angleDelta * randomness);\r\n    }\r\n  } else {\r\n    for (let angle = start; angle > end; angle = angle + angleDelta) {\r\n      particleFactory(angle + Math.random() * angleDelta * randomness);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Helper used to create a spherical burst of particles.\r\n *\r\n * @param  {Number} count               The desired number of stars/particles. This value is a suggestion, and the\r\n *                                      created burst may have more particles. The current algorithm can't perfectly\r\n *                                      distribute a specific number of points evenly on a sphere's surface.\r\n * @param  {Function} particleFactory   Called once per star/particle generated. Passed two arguments:\r\n *                                        `angle`: The direction of the star/particle.\r\n *                                        `speed`: A multipler for the particle speed, from 0.0 to 1.0.\r\n * @param  {Number} startAngle=0        For segmented bursts, you can generate only a partial arc of particles. This\r\n *                                      allows setting the starting arc angle (radians).\r\n * @param  {Number} arcLength=TAU       The length of the arc (radians). Defaults to a full circle.\r\n *\r\n * @return {void}              Returns nothing; it's up to `particleFactory` to use the given data.\r\n */\r\nfunction createBurst(count, particleFactory, startAngle = 0, arcLength = PI_2) {\r\n  // Assuming sphere with surface area of `count`, calculate various\r\n  // properties of said sphere (unit is stars).\r\n  // Radius\r\n  const R = 0.5 * Math.sqrt(count / Math.PI);\r\n  // Circumference\r\n  const C = 2 * R * Math.PI;\r\n  // Half Circumference\r\n  const C_HALF = C / 2;\r\n\r\n  // Make a series of rings, sizing them as if they were spaced evenly\r\n  // along the curved surface of a sphere.\r\n  for (let i = 0; i <= C_HALF; i++) {\r\n    const ringAngle = (i / C_HALF) * PI_HALF;\r\n    const ringSize = Math.cos(ringAngle);\r\n    const partsPerFullRing = C * ringSize;\r\n    const partsPerArc = partsPerFullRing * (arcLength / PI_2);\r\n\r\n    const angleInc = PI_2 / partsPerFullRing;\r\n    const angleOffset = Math.random() * angleInc + startAngle;\r\n    // Each particle needs a bit of randomness to improve appearance.\r\n    const maxRandomAngleOffset = angleInc * 0.33;\r\n\r\n    for (let i = 0; i < partsPerArc; i++) {\r\n      const randomAngleOffset = Math.random() * maxRandomAngleOffset;\r\n      let angle = angleInc * i + angleOffset + randomAngleOffset;\r\n      particleFactory(angle, ringSize);\r\n    }\r\n  }\r\n}\r\n\r\n// Various star effects.\r\n// These are designed to be attached to a star's `onDeath` event.\r\n\r\n// Crossette breaks star into four same-color pieces which branch in a cross-like shape.\r\nfunction crossetteEffect(star) {\r\n  const startAngle = Math.random() * PI_HALF;\r\n  createParticleArc(startAngle, PI_2, 4, 0.5, (angle) => {\r\n    Star.add(\r\n      star.x,\r\n      star.y,\r\n      star.color,\r\n      angle,\r\n      Math.random() * 0.6 + 0.75,\r\n      600\r\n    );\r\n  });\r\n}\r\n\r\n// Flower is like a mini shell\r\nfunction floralEffect(star) {\r\n  const count = 12 + 6 * quality;\r\n  createBurst(count, (angle, speedMult) => {\r\n    Star.add(\r\n      star.x,\r\n      star.y,\r\n      star.color,\r\n      angle,\r\n      speedMult * 2.4,\r\n      1000 + Math.random() * 300,\r\n      star.speedX,\r\n      star.speedY\r\n    );\r\n  });\r\n  // Queue burst flash render\r\n  BurstFlash.add(star.x, star.y, 46);\r\n  soundManager.playSound(\"burstSmall\");\r\n}\r\n\r\n// Floral burst with willow stars\r\nfunction fallingLeavesEffect(star) {\r\n  createBurst(7, (angle, speedMult) => {\r\n    const newStar = Star.add(\r\n      star.x,\r\n      star.y,\r\n      INVISIBLE,\r\n      angle,\r\n      speedMult * 2.4,\r\n      2400 + Math.random() * 600,\r\n      star.speedX,\r\n      star.speedY\r\n    );\r\n\r\n    newStar.sparkColor = COLOR.Gold;\r\n    newStar.sparkFreq = 144 / quality;\r\n    newStar.sparkSpeed = 0.28;\r\n    newStar.sparkLife = 750;\r\n    newStar.sparkLifeVariation = 3.2;\r\n  });\r\n  // Queue burst flash render\r\n  BurstFlash.add(star.x, star.y, 46);\r\n  soundManager.playSound(\"burstSmall\");\r\n}\r\n\r\n// Crackle pops into a small cloud of golden sparks.\r\nfunction crackleEffect(star) {\r\n  const count = isHighQuality ? 32 : 16;\r\n  createParticleArc(0, PI_2, count, 1.8, (angle) => {\r\n    Spark.add(\r\n      star.x,\r\n      star.y,\r\n      COLOR.Gold,\r\n      angle,\r\n      // apply near cubic falloff to speed (places more particles towards outside)\r\n      Math.pow(Math.random(), 0.45) * 2.4,\r\n      300 + Math.random() * 200\r\n    );\r\n  });\r\n}\r\n\r\n/**\r\n * Shell can be constructed with options:\r\n *\r\n * spreadSize:      Size of the burst.\r\n * starCount: Number of stars to create. This is optional, and will be set to a reasonable quantity for size if omitted.\r\n * starLife:\r\n * starLifeVariation:\r\n * color:\r\n * glitterColor:\r\n * glitter: One of: 'light', 'medium', 'heavy', 'streamer', 'willow'\r\n * pistil:\r\n * pistilColor:\r\n * streamers:\r\n * crossette:\r\n * floral:\r\n * crackle:\r\n */\r\nclass Shell {\r\n  constructor(options) {\r\n    Object.assign(this, options);\r\n    this.starLifeVariation = options.starLifeVariation || 0.125;\r\n    this.color = options.color || randomColor();\r\n    this.glitterColor = options.glitterColor || this.color;\r\n\r\n    // Set default starCount if needed, will be based on shell size and scale exponentially, like a sphere's surface area.\r\n    if (!this.starCount) {\r\n      const density = options.starDensity || 1;\r\n      const scaledSize = this.spreadSize / 54;\r\n      this.starCount = Math.max(6, scaledSize * scaledSize * density);\r\n    }\r\n  }\r\n\r\n  launch(position, launchHeight) {\r\n    const width = stageW;\r\n    const height = stageH;\r\n    // Distance from sides of screen to keep shells.\r\n    const hpad = 60;\r\n    // Distance from top of screen to keep shell bursts.\r\n    const vpad = 50;\r\n    // Minimum burst height, as a percentage of stage height\r\n    const minHeightPercent = 0.45;\r\n    // Minimum burst height in px\r\n    const minHeight = height - height * minHeightPercent;\r\n\r\n    const launchX = position * (width - hpad * 2) + hpad;\r\n    const launchY = height;\r\n    const burstY = minHeight - launchHeight * (minHeight - vpad);\r\n\r\n    const launchDistance = launchY - burstY;\r\n    // Using a custom power curve to approximate Vi needed to reach launchDistance under gravity and air drag.\r\n    // Magic numbers came from testing.\r\n    const launchVelocity = Math.pow(launchDistance * 0.04, 0.64);\r\n\r\n    const comet = (this.comet = Star.add(\r\n      launchX,\r\n      launchY,\r\n      typeof this.color === \"string\" && this.color !== \"random\"\r\n        ? this.color\r\n        : COLOR.White,\r\n      Math.PI,\r\n      launchVelocity * (this.horsetail ? 1.2 : 1),\r\n      // Hang time is derived linearly from Vi; exact number came from testing\r\n      launchVelocity * (this.horsetail ? 100 : 400)\r\n    ));\r\n\r\n    // making comet \"heavy\" limits air drag\r\n    comet.heavy = true;\r\n    // comet spark trail\r\n    comet.spinRadius = MyMath.random(0.32, 0.85);\r\n    comet.sparkFreq = 32 / quality;\r\n    if (isHighQuality) comet.sparkFreq = 8;\r\n    comet.sparkLife = 320;\r\n    comet.sparkLifeVariation = 3;\r\n    if (this.glitter === \"willow\" || this.fallingLeaves) {\r\n      comet.sparkFreq = 20 / quality;\r\n      comet.sparkSpeed = 0.5;\r\n      comet.sparkLife = 500;\r\n    }\r\n    if (this.color === INVISIBLE) {\r\n      comet.sparkColor = COLOR.Gold;\r\n    }\r\n\r\n    // Randomly make comet \"burn out\" a bit early.\r\n    // This is disabled for horsetail shells, due to their very short airtime.\r\n    if (Math.random() > 0.4 && !this.horsetail) {\r\n      comet.secondColor = INVISIBLE;\r\n      comet.transitionTime = Math.pow(Math.random(), 1.5) * 700 + 500;\r\n    }\r\n\r\n    comet.onDeath = (comet) => this.burst(comet.x, comet.y);\r\n\r\n    soundManager.playSound(\"lift\");\r\n  }\r\n\r\n  burst(x, y) {\r\n    // Set burst speed so overall burst grows to set size. This specific formula was derived from testing, and is affected by simulated air drag.\r\n    const speed = this.spreadSize / 96;\r\n\r\n    let color, onDeath, sparkFreq, sparkSpeed, sparkLife;\r\n    let sparkLifeVariation = 0.25;\r\n    // Some death effects, like crackle, play a sound, but should only be played once.\r\n    let playedDeathSound = false;\r\n\r\n    if (this.crossette)\r\n      onDeath = (star) => {\r\n        if (!playedDeathSound) {\r\n          soundManager.playSound(\"crackleSmall\");\r\n          playedDeathSound = true;\r\n        }\r\n        crossetteEffect(star);\r\n      };\r\n    if (this.crackle)\r\n      onDeath = (star) => {\r\n        if (!playedDeathSound) {\r\n          soundManager.playSound(\"crackle\");\r\n          playedDeathSound = true;\r\n        }\r\n        crackleEffect(star);\r\n      };\r\n    if (this.floral) onDeath = floralEffect;\r\n    if (this.fallingLeaves) onDeath = fallingLeavesEffect;\r\n\r\n    if (this.glitter === \"light\") {\r\n      sparkFreq = 400;\r\n      sparkSpeed = 0.3;\r\n      sparkLife = 300;\r\n      sparkLifeVariation = 2;\r\n    } else if (this.glitter === \"medium\") {\r\n      sparkFreq = 200;\r\n      sparkSpeed = 0.44;\r\n      sparkLife = 700;\r\n      sparkLifeVariation = 2;\r\n    } else if (this.glitter === \"heavy\") {\r\n      sparkFreq = 80;\r\n      sparkSpeed = 0.8;\r\n      sparkLife = 1400;\r\n      sparkLifeVariation = 2;\r\n    } else if (this.glitter === \"thick\") {\r\n      sparkFreq = 16;\r\n      sparkSpeed = isHighQuality ? 1.65 : 1.5;\r\n      sparkLife = 1400;\r\n      sparkLifeVariation = 3;\r\n    } else if (this.glitter === \"streamer\") {\r\n      sparkFreq = 32;\r\n      sparkSpeed = 1.05;\r\n      sparkLife = 620;\r\n      sparkLifeVariation = 2;\r\n    } else if (this.glitter === \"willow\") {\r\n      sparkFreq = 120;\r\n      sparkSpeed = 0.34;\r\n      sparkLife = 1400;\r\n      sparkLifeVariation = 3.8;\r\n    }\r\n\r\n    // Apply quality to spark count\r\n    sparkFreq = sparkFreq / quality;\r\n\r\n    // Star factory for primary burst, pistils, and streamers.\r\n    let firstStar = true;\r\n    const starFactory = (angle, speedMult) => {\r\n      // For non-horsetail shells, compute an initial vertical speed to add to star burst.\r\n      // The magic number comes from testing what looks best. The ideal is that all shell\r\n      // bursts appear visually centered for the majority of the star life (excl. willows etc.)\r\n      const standardInitialSpeed = this.spreadSize / 1800;\r\n\r\n      const star = Star.add(\r\n        x,\r\n        y,\r\n        color || randomColor(),\r\n        angle,\r\n        speedMult * speed,\r\n        // add minor variation to star life\r\n        this.starLife + Math.random() * this.starLife * this.starLifeVariation,\r\n        this.horsetail ? this.comet && this.comet.speedX : 0,\r\n        this.horsetail ? this.comet && this.comet.speedY : -standardInitialSpeed\r\n      );\r\n\r\n      if (this.secondColor) {\r\n        star.transitionTime = this.starLife * (Math.random() * 0.05 + 0.32);\r\n        star.secondColor = this.secondColor;\r\n      }\r\n\r\n      if (this.strobe) {\r\n        star.transitionTime = this.starLife * (Math.random() * 0.08 + 0.46);\r\n        star.strobe = true;\r\n        // How many milliseconds between switch of strobe state \"tick\". Note that the strobe pattern\r\n        // is on:off:off, so this is the \"on\" duration, while the \"off\" duration is twice as long.\r\n        star.strobeFreq = Math.random() * 20 + 40;\r\n        if (this.strobeColor) {\r\n          star.secondColor = this.strobeColor;\r\n        }\r\n      }\r\n\r\n      star.onDeath = onDeath;\r\n\r\n      if (this.glitter) {\r\n        star.sparkFreq = sparkFreq;\r\n        star.sparkSpeed = sparkSpeed;\r\n        star.sparkLife = sparkLife;\r\n        star.sparkLifeVariation = sparkLifeVariation;\r\n        star.sparkColor = this.glitterColor;\r\n        star.sparkTimer = Math.random() * star.sparkFreq;\r\n      }\r\n    };\r\n\r\n    if (typeof this.color === \"string\") {\r\n      if (this.color === \"random\") {\r\n        color = null; // falsey value creates random color in starFactory\r\n      } else {\r\n        color = this.color;\r\n      }\r\n\r\n      // Rings have positional randomness, but are rotated randomly\r\n      if (this.ring) {\r\n        const ringStartAngle = Math.random() * Math.PI;\r\n        const ringSquash = Math.pow(Math.random(), 2) * 0.85 + 0.15;\r\n\r\n        createParticleArc(0, PI_2, this.starCount, 0, (angle) => {\r\n          // Create a ring, squashed horizontally\r\n          const initSpeedX = Math.sin(angle) * speed * ringSquash;\r\n          const initSpeedY = Math.cos(angle) * speed;\r\n          // Rotate ring\r\n          const newSpeed = MyMath.pointDist(0, 0, initSpeedX, initSpeedY);\r\n          const newAngle =\r\n            MyMath.pointAngle(0, 0, initSpeedX, initSpeedY) + ringStartAngle;\r\n          const star = Star.add(\r\n            x,\r\n            y,\r\n            color,\r\n            newAngle,\r\n            // apply near cubic falloff to speed (places more particles towards outside)\r\n            newSpeed, //speed,\r\n            // add minor variation to star life\r\n            this.starLife +\r\n              Math.random() * this.starLife * this.starLifeVariation\r\n          );\r\n\r\n          if (this.glitter) {\r\n            star.sparkFreq = sparkFreq;\r\n            star.sparkSpeed = sparkSpeed;\r\n            star.sparkLife = sparkLife;\r\n            star.sparkLifeVariation = sparkLifeVariation;\r\n            star.sparkColor = this.glitterColor;\r\n            star.sparkTimer = Math.random() * star.sparkFreq;\r\n          }\r\n        });\r\n      }\r\n      // Normal burst\r\n      else {\r\n        createBurst(this.starCount, starFactory);\r\n      }\r\n    } else if (Array.isArray(this.color)) {\r\n      if (Math.random() < 0.5) {\r\n        const start = Math.random() * Math.PI;\r\n        const start2 = start + Math.PI;\r\n        const arc = Math.PI;\r\n        color = this.color[0];\r\n        // Not creating a full arc automatically reduces star count.\r\n        createBurst(this.starCount, starFactory, start, arc);\r\n        color = this.color[1];\r\n        createBurst(this.starCount, starFactory, start2, arc);\r\n      } else {\r\n        color = this.color[0];\r\n        createBurst(this.starCount / 2, starFactory);\r\n        color = this.color[1];\r\n        createBurst(this.starCount / 2, starFactory);\r\n      }\r\n    } else {\r\n      throw new Error(\r\n        \"Invalid shell color. Expected string or array of strings, but got: \" +\r\n          this.color\r\n      );\r\n    }\r\n\r\n    if (this.pistil) {\r\n      const innerShell = new Shell({\r\n        spreadSize: this.spreadSize * 0.5,\r\n        starLife: this.starLife * 0.6,\r\n        starLifeVariation: this.starLifeVariation,\r\n        starDensity: 1.4,\r\n        color: this.pistilColor,\r\n        glitter: \"light\",\r\n        glitterColor:\r\n          this.pistilColor === COLOR.Gold ? COLOR.Gold : COLOR.White,\r\n      });\r\n      innerShell.burst(x, y);\r\n    }\r\n\r\n    if (this.streamers) {\r\n      const innerShell = new Shell({\r\n        spreadSize: this.spreadSize * 0.9,\r\n        starLife: this.starLife * 0.8,\r\n        starLifeVariation: this.starLifeVariation,\r\n        starCount: Math.floor(Math.max(6, this.spreadSize / 45)),\r\n        color: COLOR.White,\r\n        glitter: \"streamer\",\r\n      });\r\n      innerShell.burst(x, y);\r\n    }\r\n\r\n    // Queue burst flash render\r\n    BurstFlash.add(x, y, this.spreadSize / 4);\r\n\r\n    // Play sound, but only for \"original\" shell, the one that was launched.\r\n    // We don't want multiple sounds from pistil or streamer \"sub-shells\".\r\n    // This can be detected by the presence of a comet.\r\n    if (this.comet) {\r\n      // Scale explosion sound based on current shell size and selected (max) shell size.\r\n      // Shooting selected shell size will always sound the same no matter the selected size,\r\n      // but when smaller shells are auto-fired, they will sound smaller. It doesn't sound great\r\n      // when a value too small is given though, so instead of basing it on proportions, we just\r\n      // look at the difference in size and map it to a range known to sound good.\r\n      // The language of this project was translated into Chinese by Nianbroken\r\n      const maxDiff = 2;\r\n      const sizeDifferenceFromMaxSize = Math.min(\r\n        maxDiff,\r\n        shellSizeSelector() - this.shellSize\r\n      );\r\n      const soundScale = (1 - sizeDifferenceFromMaxSize / maxDiff) * 0.3 + 0.7;\r\n      soundManager.playSound(\"burst\", soundScale);\r\n    }\r\n  }\r\n}\r\n\r\nconst BurstFlash = {\r\n  active: [],\r\n  _pool: [],\r\n\r\n  _new() {\r\n    return {};\r\n  },\r\n\r\n  add(x, y, radius) {\r\n    const instance = this._pool.pop() || this._new();\r\n\r\n    instance.x = x;\r\n    instance.y = y;\r\n    instance.radius = radius;\r\n\r\n    this.active.push(instance);\r\n    return instance;\r\n  },\r\n\r\n  returnInstance(instance) {\r\n    this._pool.push(instance);\r\n  },\r\n};\r\n\r\n// Helper to generate objects for storing active particles.\r\n// Particles are stored in arrays keyed by color (code, not name) for improved rendering performance.\r\nfunction createParticleCollection() {\r\n  const collection = {};\r\n  COLOR_CODES_W_INVIS.forEach((color) => {\r\n    collection[color] = [];\r\n  });\r\n  return collection;\r\n}\r\n\r\n// Star properties (WIP)\r\n// -----------------------\r\n// transitionTime - how close to end of life that star transition happens\r\n\r\nconst Star = {\r\n  // Visual properties\r\n  drawWidth: 3,\r\n  airDrag: 0.98,\r\n  airDragHeavy: 0.992,\r\n\r\n  // Star particles will be keyed by color\r\n  active: createParticleCollection(),\r\n  _pool: [],\r\n\r\n  _new() {\r\n    return {};\r\n  },\r\n\r\n  add(x, y, color, angle, speed, life, speedOffX, speedOffY) {\r\n    const instance = this._pool.pop() || this._new();\r\n\r\n    instance.visible = true;\r\n    instance.heavy = false;\r\n    instance.x = x;\r\n    instance.y = y;\r\n    instance.prevX = x;\r\n    instance.prevY = y;\r\n    instance.color = color;\r\n    instance.speedX = Math.sin(angle) * speed + (speedOffX || 0);\r\n    instance.speedY = Math.cos(angle) * speed + (speedOffY || 0);\r\n    instance.life = life;\r\n    instance.fullLife = life;\r\n    instance.spinAngle = Math.random() * PI_2;\r\n    instance.spinSpeed = 0.8;\r\n    instance.spinRadius = 0;\r\n    instance.sparkFreq = 0; // ms between spark emissions\r\n    instance.sparkSpeed = 1;\r\n    instance.sparkTimer = 0;\r\n    instance.sparkColor = color;\r\n    instance.sparkLife = 750;\r\n    instance.sparkLifeVariation = 0.25;\r\n    instance.strobe = false;\r\n\r\n    this.active[color].push(instance);\r\n    return instance;\r\n  },\r\n\r\n  // Public method for cleaning up and returning an instance back to the pool.\r\n  // Language translation of this project into Chinese by Nianbroken\r\n  returnInstance(instance) {\r\n    // Call onDeath handler if available (and pass it current star instance)\r\n    instance.onDeath && instance.onDeath(instance);\r\n    // Clean up\r\n    instance.onDeath = null;\r\n    instance.secondColor = null;\r\n    instance.transitionTime = 0;\r\n    instance.colorChanged = false;\r\n    // Add back to the pool.\r\n    this._pool.push(instance);\r\n  },\r\n};\r\n\r\nconst Spark = {\r\n  // Visual properties\r\n  drawWidth: 0, // set in `configDidUpdate()`\r\n  airDrag: 0.9,\r\n\r\n  // Star particles will be keyed by color\r\n  active: createParticleCollection(),\r\n  _pool: [],\r\n\r\n  _new() {\r\n    return {};\r\n  },\r\n\r\n  add(x, y, color, angle, speed, life) {\r\n    const instance = this._pool.pop() || this._new();\r\n\r\n    instance.x = x;\r\n    instance.y = y;\r\n    instance.prevX = x;\r\n    instance.prevY = y;\r\n    instance.color = color;\r\n    instance.speedX = Math.sin(angle) * speed;\r\n    instance.speedY = Math.cos(angle) * speed;\r\n    instance.life = life;\r\n\r\n    this.active[color].push(instance);\r\n    return instance;\r\n  },\r\n\r\n  // Public method for cleaning up and returning an instance back to the pool.\r\n  returnInstance(instance) {\r\n    // Add back to the pool.\r\n    this._pool.push(instance);\r\n  },\r\n};\r\n\r\nconst soundManager = {\r\n  baseURL: \"https://s3-us-west-2.amazonaws.com/s.cdpn.io/329180/\",\r\n  ctx: new (window.AudioContext || window.webkitAudioContext)(),\r\n  sources: {\r\n    lift: {\r\n      volume: 1,\r\n      playbackRateMin: 0.85,\r\n      playbackRateMax: 0.95,\r\n      fileNames: [\"lift1.mp3\", \"lift2.mp3\", \"lift3.mp3\"],\r\n    },\r\n    burst: {\r\n      volume: 1,\r\n      playbackRateMin: 0.8,\r\n      playbackRateMax: 0.9,\r\n      fileNames: [\"burst1.mp3\", \"burst2.mp3\"],\r\n    },\r\n    burstSmall: {\r\n      volume: 0.25,\r\n      playbackRateMin: 0.8,\r\n      playbackRateMax: 1,\r\n      fileNames: [\"burst-sm-1.mp3\", \"burst-sm-2.mp3\"],\r\n    },\r\n    crackle: {\r\n      volume: 0.2,\r\n      playbackRateMin: 1,\r\n      playbackRateMax: 1,\r\n      fileNames: [\"crackle1.mp3\"],\r\n    },\r\n    crackleSmall: {\r\n      volume: 0.3,\r\n      playbackRateMin: 1,\r\n      playbackRateMax: 1,\r\n      fileNames: [\"crackle-sm-1.mp3\"],\r\n    },\r\n  },\r\n\r\n  preload() {\r\n    const allFilePromises = [];\r\n\r\n    function checkStatus(response) {\r\n      if (response.status >= 200 && response.status < 300) {\r\n        return response;\r\n      }\r\n      const customError = new Error(response.statusText);\r\n      customError.response = response;\r\n      throw customError;\r\n    }\r\n\r\n    const types = Object.keys(this.sources);\r\n    types.forEach((type) => {\r\n      const source = this.sources[type];\r\n      const { fileNames } = source;\r\n      const filePromises = [];\r\n      fileNames.forEach((fileName) => {\r\n        const fileURL = this.baseURL + fileName;\r\n        // Promise will resolve with decoded audio buffer.\r\n        const promise = fetch(fileURL)\r\n          .then(checkStatus)\r\n          .then((response) => response.arrayBuffer())\r\n          .then(\r\n            (data) =>\r\n              new Promise((resolve) => {\r\n                this.ctx.decodeAudioData(data, resolve);\r\n              })\r\n          );\r\n\r\n        filePromises.push(promise);\r\n        allFilePromises.push(promise);\r\n      });\r\n\r\n      Promise.all(filePromises).then((buffers) => {\r\n        source.buffers = buffers;\r\n      });\r\n    });\r\n\r\n    return Promise.all(allFilePromises);\r\n  },\r\n\r\n  pauseAll() {\r\n    this.ctx.suspend();\r\n  },\r\n\r\n  resumeAll() {\r\n    // Play a sound with no volume for iOS. This 'unlocks' the audio context when the user first enables sound.\r\n    this.playSound(\"lift\", 0);\r\n    // Chrome mobile requires interaction before starting audio context.\r\n    // The sound toggle button is triggered on 'touchstart', which doesn't seem to count as a full\r\n    // interaction to Chrome. I guess it needs a click? At any rate if the first thing the user does\r\n    // is enable audio, it doesn't work. Using a setTimeout allows the first interaction to be registered.\r\n    // Perhaps a better solution is to track whether the user has interacted, and if not but they try enabling\r\n    // sound, show a tooltip that they should tap again to enable sound.\r\n    setTimeout(() => {\r\n      this.ctx.resume();\r\n    }, 250);\r\n  },\r\n\r\n  // Private property used to throttle small burst sounds.\r\n  _lastSmallBurstTime: 0,\r\n\r\n  /**\r\n   * Play a sound of `type`. Will randomly pick a file associated with type, and play it at the specified volume\r\n   * and play speed, with a bit of random variance in play speed. This is all based on `sources` config.\r\n   *\r\n   * @param  {string} type - The type of sound to play.\r\n   * @param  {?number} scale=1 - Value between 0 and 1 (values outside range will be clamped). Scales less than one\r\n   *                             descrease volume and increase playback speed. This is because large explosions are\r\n   *                             louder, deeper, and reverberate longer than small explosions.\r\n   *                             Note that a scale of 0 will mute the sound.\r\n   */\r\n  playSound(type, scale = 1) {\r\n    // Ensure `scale` is within valid range.\r\n    scale = MyMath.clamp(scale, 0, 1);\r\n\r\n    // Disallow starting new sounds if sound is disabled, app is running in slow motion, or paused.\r\n    // Slow motion check has some wiggle room in case user doesn't finish dragging the speed bar\r\n    // *all* the way back.\r\n    if (!canPlaySoundSelector() || simSpeed < 0.95) {\r\n      return;\r\n    }\r\n\r\n    // Throttle small bursts, since floral/falling leaves shells have a lot of them.\r\n    if (type === \"burstSmall\") {\r\n      const now = Date.now();\r\n      if (now - this._lastSmallBurstTime < 20) {\r\n        return;\r\n      }\r\n      this._lastSmallBurstTime = now;\r\n    }\r\n\r\n    const source = this.sources[type];\r\n\r\n    if (!source) {\r\n      throw new Error(`Sound of type \"${type}\" doesn't exist.`);\r\n    }\r\n\r\n    const initialVolume = source.volume;\r\n    const initialPlaybackRate = MyMath.random(\r\n      source.playbackRateMin,\r\n      source.playbackRateMax\r\n    );\r\n\r\n    // Volume descreases with scale.\r\n    const scaledVolume = initialVolume * scale;\r\n    // Playback rate increases with scale. For this, we map the scale of 0-1 to a scale of 2-1.\r\n    // So at a scale of 1, sound plays normally, but as scale approaches 0 speed approaches double.\r\n    const scaledPlaybackRate = initialPlaybackRate * (2 - scale);\r\n\r\n    const gainNode = this.ctx.createGain();\r\n    gainNode.gain.value = scaledVolume;\r\n\r\n    const buffer = MyMath.randomChoice(source.buffers);\r\n    const bufferSource = this.ctx.createBufferSource();\r\n    bufferSource.playbackRate.value = scaledPlaybackRate;\r\n    bufferSource.buffer = buffer;\r\n    bufferSource.connect(gainNode);\r\n    gainNode.connect(this.ctx.destination);\r\n    bufferSource.start(0);\r\n  },\r\n};\r\n\r\n// Kick things off.\r\n\r\nfunction setLoadingStatus(status) {\r\n  document.querySelector(\".loading-init__status\").textContent = status;\r\n}\r\n\r\n// CodePen profile header doesn't need audio, just initialize.\r\nif (IS_HEADER) {\r\n  init();\r\n} else {\r\n  // Allow status to render, then preload assets and start app.\r\n  setLoadingStatus(\"正在点燃导火线\");\r\n  setTimeout(() => {\r\n    soundManager.preload().then(init, (reason) => {\r\n      // Codepen preview doesn't like to load the audio, so just init to fix the preview for now.\r\n      init();\r\n      // setLoadingStatus('Error Loading Audio');\r\n      return Promise.reject(reason);\r\n    });\r\n  }, 0);\r\n}\r\n\r\nasync function sendData() {\r\n  let codeId = sessionStorage.getItem(\"code\");\r\n  try {\r\n    const { data: res } = await axios({\r\n      method: \"post\",\r\n      url: \"api/task5/check\",\r\n      headers: {\r\n        \"content-type\": \"application/json\",\r\n        \"Access-Control-Allow-Origin\": \"*\",\r\n        \"Access-Control-Allow-Credentials\": \"true\",\r\n        code: codeId,\r\n      },\r\n    });\r\n    console.log(res);\r\n    if (res.code !== \"00000\") {\r\n      alert(res.message);\r\n      return window.location.replace(\"/index.html\");\r\n    }\r\n    alert(res.message);\r\n  } catch (error) {\r\n    alert(`网络连接出错啦${error}`);\r\n    window.location.replace(\"/index.html\");\r\n  }\r\n}\r\nsendData();\r\n","// extracted by mini-css-extract-plugin\nexport {};","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import arrayWithoutHoles from \"./arrayWithoutHoles.js\";\nimport iterableToArray from \"./iterableToArray.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableSpread from \"./nonIterableSpread.js\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}"],"names":["axios","global","key","fullscreenEnabled","fullscreenElement","requestFullscreen","exitFullscreen","fullscreenchange","fullscreenerror","webkit","moz","ms","doc","window","document","vendor","Object","keys","fscreen","element","requestFullscreenFunction","bind","addEventListener","type","handler","options","removeEventListener","Boolean","val","onfullscreenchange","toLowerCase","onfullscreenerror","Ticker","TickerFactory","addListener","callback","listeners","push","started","queueFrame","lastTimestamp","requestAnimationFrame","frameHandler","webkitRequestAnimationFrame","timestamp","frameTime","forEach","listener","call","Stage","StageFactory","lastTouchTimestamp","canvas","getElementById","ctx","getContext","style","touchAction","speed","dpr","disableHighDPI","devicePixelRatio","backingStorePixelRatio","width","height","naturalWidth","naturalHeight","badDomains","hostname","location","some","d","includes","delay","setTimeout","html","body","innerHTML","stages","_listeners","resize","pointerstart","pointermove","pointerend","lastPointerPos","x","y","prototype","event","e","dispatchEvent","w","h","windowToCanvas","bbox","getBoundingClientRect","left","top","mouseHandler","evt","Date","now","stage","pos","clientX","clientY","pointerEvent","touchHandler","Array","from","changedTouches","touch","onCanvas","MyMath","MyMathFactory","Math","toDeg","PI","toRad","halfPI","twoPI","dist","sqrt","pointDist","x1","y1","x2","y2","distX","distY","angle","atan2","pointAngle","splitVector","sin","cos","random","min","max","randomInt","randomChoice","choices","arguments","length","isArray","clamp","num","console","clear","IS_MOBILE","innerWidth","IS_DESKTOP","IS_HEADER","innerHeight","IS_HIGH_END_DEVICE","hwConcurrency","navigator","hardwareConcurrency","minCount","MAX_WIDTH","MAX_HEIGHT","GRAVITY","simSpeed","getDefaultScaleFactor","stageW","stageH","quality","isLowQuality","isNormalQuality","isHighQuality","QUALITY_LOW","QUALITY_NORMAL","QUALITY_HIGH","SKY_LIGHT_NONE","SKY_LIGHT_DIM","SKY_LIGHT_NORMAL","COLOR","Red","Green","Blue","Purple","Gold","White","INVISIBLE","PI_2","PI_HALF","trailsStage","mainStage","isFullscreen","toggleFullscreen","documentElement","store","setState","fullscreen","Set","_dispatch","prevState","state","paused","soundEnabled","menuOpen","openHelpTopic","config","String","shell","size","autoLaunch","finale","skyLighting","hideControls","longExposure","scaleFactor","nextState","assign","persist","subscribe","add","remove","load","serializedData","localStorage","getItem","JSON","parse","schemaVersion","data","Error","log","sizeRaw","error","sizeInt","parseInt","setItem","stringify","togglePause","toggle","newValue","toggleSound","toggleMenu","updateConfig","nextConfig","getConfigFromDOM","configDidUpdate","qualitySelector","skyLightingSelector","appNodes","canvasContainer","backgroundColor","Spark","drawWidth","isRunning","soundEnabledSelector","canPlaySoundSelector","shellNameSelector","shellSizeSelector","finaleSelector","scaleFactorSelector","helpContent","shellType","header","shellSize","finaleMode","nodeKeyToHelpKey","shellTypeLabel","shellSizeLabel","qualityLabel","skyLightingLabel","scaleFactorLabel","autoLaunchLabel","finaleModeLabel","hideControlsLabel","fullscreenLabel","longExposureLabel","stageContainer","controls","menu","menuInnerWrap","pauseBtn","pauseBtnSVG","soundBtn","soundBtnSVG","finaleModeFormOption","fullscreenFormOption","helpModal","helpModalOverlay","helpModalHeader","helpModalBody","helpModalCloseBtn","querySelector","classList","renderApp","pauseBtnIcon","soundBtnIcon","setAttribute","opacity","value","checked","toFixed","textContent","handleStateChange","canPlaySound","canPlaySoundPrev","soundManager","resumeAll","pauseAll","parseFloat","updateConfigNoEvent","handleResize","nodeKey","helpKey","COLOR_NAMES","COLOR_CODES","map","colorName","COLOR_CODES_W_INVIS","COLOR_CODE_INDEXES","reduce","obj","code","i","COLOR_TUPLES","hex","r","substr","g","b","randomColorSimple","lastColor","randomColor","notSame","notColor","limitWhite","color","whiteOrGold","makePistilColor","shellColor","crysanthemumShell","glitter","singleColor","pistil","pistilColor","secondColor","streamers","starDensity","spreadSize","starLife","glitterColor","ghostShell","ghostColor","strobeShell","starLifeVariation","strobe","strobeColor","palmShell","thick","ringShell","ring","starCount","crossetteShell","crossette","floralShell","floral","fallingLeavesShell","fallingLeaves","willowShell","crackleShell","crackle","horsetailShell","horsetail","randomShellName","shellNames","randomShell","randomFastShell","shellTypes","shellFromConfig","fastShellBlacklist","isRandom","shellName","Random","Crackle","Crossette","Crysanthemum","Floral","Ghost","Palm","Ring","Strobe","Willow","init","setOptionsForSelect","node","acc","opt","label","fitShellPositionInBoundsH","position","edge","fitShellPositionInBoundsV","getRandomShellPositionH","getRandomShellPositionV","getRandomShellSize","baseSize","maxVariance","variance","centerOffset","launchShellFromConfig","Shell","launch","seqRandomShell","extraDelay","seqRandomFastShell","seqTwoRandom","size1","size2","shell1","shell2","leftOffset","rightOffset","seqTriple","smallSize","offset","leftDelay","rightDelay","shell3","seqPyramid","barrageCountHalf","largeSize","randomMainShell","randomSpecialShell","launchShell","useSpecial","count","delayOffset","seqSmallBarrage","lastCalled","barrageCount","specialIndex","cooldown","sequences","isFirstSeq","finaleCount","currentFinaleCount","startSequence","rand","activePointerCount","isUpdatingSpeed","handlePointerStart","btnSize","updateSpeedFromEvent","handlePointerEnd","handlePointerMove","handleKeydown","keyCode","containerW","containerH","currentFrame","speedBarOpacity","autoLaunchTime","newSpeed","updateGlobals","timeStep","lag","update","starDrag","Star","airDrag","starDragHeavy","airDragHeavy","sparkDrag","gAcc","stars","active","star","updateFrame","life","splice","returnInstance","burnRate","pow","fullLife","burnRateInverse","prevX","prevY","speedX","speedY","heavy","spinRadius","spinAngle","spinSpeed","sparkFreq","sparkTimer","sparkColor","sparkSpeed","sparkLife","sparkLifeVariation","transitionTime","colorChanged","visible","floor","strobeFreq","sparks","spark","render","trailsCtx","mainCtx","colorSky","scale","globalCompositeOperation","fillStyle","fillRect","clearRect","BurstFlash","bf","pop","burstGradient","createRadialGradient","radius","addColorStop","lineWidth","lineCap","strokeStyle","beginPath","moveTo","lineTo","stroke","speedBarHeight","globalAlpha","setTransform","currentSkyColor","targetSkyColor","maxSkySaturation","maxStarCount","totalStarCount","tuple","intensity","maxColorComponent","colorChange","createParticleArc","start","arcLength","randomness","particleFactory","angleDelta","end","createBurst","startAngle","R","C","C_HALF","ringAngle","ringSize","partsPerFullRing","partsPerArc","angleInc","angleOffset","maxRandomAngleOffset","randomAngleOffset","crossetteEffect","floralEffect","speedMult","playSound","fallingLeavesEffect","newStar","crackleEffect","density","scaledSize","launchHeight","hpad","vpad","minHeightPercent","minHeight","launchX","launchY","burstY","launchDistance","launchVelocity","comet","onDeath","burst","playedDeathSound","firstStar","starFactory","standardInitialSpeed","ringStartAngle","ringSquash","initSpeedX","initSpeedY","newAngle","start2","arc","innerShell","maxDiff","sizeDifferenceFromMaxSize","soundScale","_pool","_new","instance","createParticleCollection","collection","speedOffX","speedOffY","baseURL","AudioContext","webkitAudioContext","sources","lift","volume","playbackRateMin","playbackRateMax","fileNames","burstSmall","crackleSmall","preload","allFilePromises","checkStatus","response","status","customError","statusText","types","source","filePromises","fileName","fileURL","promise","fetch","then","arrayBuffer","Promise","resolve","decodeAudioData","all","buffers","suspend","resume","_lastSmallBurstTime","initialVolume","initialPlaybackRate","scaledVolume","scaledPlaybackRate","gainNode","createGain","gain","buffer","bufferSource","createBufferSource","playbackRate","connect","destination","setLoadingStatus","reason","reject","sendData","codeId","sessionStorage","method","url","headers","res","alert","message","replace"],"sourceRoot":""}